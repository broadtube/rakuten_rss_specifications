# RssIndexMarket 非公式テスト確認仕様

## 概要
**関数名**: RssIndexMarket  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 指数情報の取得  

**説明**: 指定された指数の情報をExcelに表示します。日経平均、TOPIX、その他各種指数のリアルタイムデータを取得できます。

## 構文 (Syntax)

```excel
RssIndexMarket("指数コード", "取得項目")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 指数コード | string | 必須 | 指数の識別コード（下記コード表参照） |
| 2 | 取得項目 | string | 必須 | 指数情報の取得項目名 |

## 主要な指数コード

| 指数コード | 指数名 | 説明 |
|------------|--------|------|
| N225 | 日経平均株価 | 日経225 |
| TOPIX | 東証株価指数 | TOPIX |
| MOTHERS | マザーズ指数 | 東証マザーズ指数 |
| JASDAQ | JASDAQ指数 | JASDAQ総合指数 |
| TSE2 | 東証2部指数 | 東証第二部総合株価指数 |
| REIT | 東証REIT指数 | 東証REIT指数 |

## 主要な取得項目

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 現在値 | 現在の指数値 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |
| 出来高 | 売買高 | number |

## 使用例

### 基本的な使用方法
```excel
=RssIndexMarket("N225", "現在値")
```
日経平均株価の現在値を表示します。

### 複数指数の監視
```excel
=RssIndexMarket("N225", "現在値")    // 日経平均
=RssIndexMarket("TOPIX", "現在値")   // TOPIX
=RssIndexMarket("MOTHERS", "現在値") // マザーズ指数
```

### 指数の詳細情報取得
```excel
=RssIndexMarket("N225", "始値")
=RssIndexMarket("N225", "高値")
=RssIndexMarket("N225", "安値")
=RssIndexMarket("N225", "前日比")
```
日経平均の各種データを取得します。

### セル参照での使用
A1セルに指数コード「TOPIX」、B1セルに「現在値」が入力されている場合：
```excel
=RssIndexMarket(A1, B1)
```

## 戻り値

### 成功時の出力形式

**データ構造**: 単一セル
- **関数セル**: 指定した取得項目の値

### 実際の出力例

#### 日経平均の現在値
```excel
=RssIndexMarket("N225", "現在値")
```
結果：`28450.75` （数値、小数点以下2桁まで）

#### TOPIXの前日比
```excel
=RssIndexMarket("TOPIX", "前日比")
```
結果：`+12.50` （数値、±表記）

#### マザーズ指数の前日比率
```excel
=RssIndexMarket("MOTHERS", "前日比率")
```
結果：`1.25` （数値、%記号なし）

### 取得項目別の値範囲・形式

| 取得項目 | データ型 | 値の範囲・形式 | 例 | 備考 |
|----------|----------|----------------|-----|------|
| 現在値 | number | 正数（指数値）<br>小数点以下2桁まで | `28450.75`, `2050.25` | 指数ポイント |
| 前日終値 | number | 正数（指数値） | `28380.50`, `2040.00` | 指数ポイント |
| 始値 | number | 正数（指数値） | `28420.00`, `2045.50` | 当日始値 |
| 高値 | number | 正数（指数値） | `28520.25`, `2055.75` | 当日高値 |
| 安値 | number | 正数（指数値） | `28350.00`, `2038.25` | 当日安値 |
| 前日比 | number | 実数（±） | `+70.25`, `-15.50` | 前日終値からの差 |
| 前日比率 | number | 実数（%） | `0.25`, `-0.76` | パーセント値（%記号なし） |
| 出来高 | number | 0以上整数 | `1250000000`, `890000000` | 売買高（千株単位等） |

### 指数別の値範囲参考

| 指数コード | 指数名 | 一般的な値範囲 | 小数点桁数 |
|------------|--------|----------------|------------|
| N225 | 日経平均株価 | 20000-35000程度 | 小数点以下2桁 |
| TOPIX | 東証株価指数 | 1500-2500程度 | 小数点以下2桁 |
| MOTHERS | マザーズ指数 | 800-1500程度 | 小数点以下2桁 |
| JASDAQ | JASDAQ指数 | 150-250程度 | 小数点以下2桁 |
| REIT | 東証REIT指数 | 1500-2500程度 | 小数点以下2桁 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 指数コード無効、取得項目無効、市場休場等
- `#REF!` - セル参照エラー

### 特別なケース

#### 市場休場時
```excel
=RssIndexMarket("N225", "現在値")
```
結果：`#N/A`

#### 無効な指数コード
```excel
=RssIndexMarket("INVALID", "現在値")
```
結果：`#N/A`

#### 算出時間外
```excel
=RssIndexMarket("N225", "現在値")  // 夜間時間帯
```
結果：前場終了時の値または`#N/A`

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 指数コード、取得項目の形式を確認 |
| #N/A | 指数コード無効、市場休場等 | 指数コードと市場時間を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssMarket**: 国内株式市況情報
- **RssFXMarket**: 為替レート情報
- **RssMarketHeader**: 市況情報ヘッダー行作成
- **RssFOPMarket**: 先物OP市況情報

## 注意事項

1. **市場時間**: データは各指数の算出時間に依存します
2. **リアルタイムデータ**: 情報更新頻度はマーケットスピード IIに準拠
3. **指数コード**: 正確な指数コードを指定する必要があります
4. **取得項目**: 取得可能な項目は指数により異なる場合があります
5. **データ精度**: 指数値は小数点以下の精度を持つ場合があります

## 指数の特性

| 指数分類 | 特徴 | 代表指数 |
|----------|------|----------|
| 代表指数 | 市場全体を代表 | 日経225、TOPIX |
| 市場別指数 | 特定市場の動向 | マザーズ、JASDAQ |
| セクター指数 | 業種別動向 | 各業種指数 |
| 投資対象指数 | 投資商品の基準 | REIT指数 |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「指数情報」