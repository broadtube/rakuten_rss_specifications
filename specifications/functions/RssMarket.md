# RssMarket 完全仕様書

## 概要
**関数名**: RssMarket  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 国内株式の市況情報取得  

**説明**: 指定された国内株式の個別銘柄の市況情報をExcelに表示します。現在値、始値、高値、安値、出来高、VWAP等のリアルタイム市場データを取得できます。

## 構文 (Syntax)

```excel
RssMarket("銘柄コード", "取得項目")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 銘柄コード | string | 必須 | **英数字4桁(5桁)**: 東証<br>**英数字4桁(5桁).T**: 東証<br>**英数字4桁(5桁).JAX**: JASDAQ<br>**英数字4桁(5桁).JNX**: JNX |
| 2 | 取得項目 | string | 必須 | 市況情報の取得項目名（下記項目表参照） |

## 主要な取得項目

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 現在値 | 現在の株価 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 出来高 | 当日出来高 | number |
| VWAP | 出来高加重平均価格 | number |
| 銘柄名称 | 銘柄の正式名称 | string |

## 使用例

### 基本的な使用方法
```excel
=RssMarket("4755.T", "現在値")
```
楽天株の現在値を表示します。

### 複数データの取得
```excel
=RssMarket("7203", "始値")
=RssMarket("7203", "高値")  
=RssMarket("7203", "安値")
=RssMarket("7203", "出来高")
```
トヨタ株の各種市況データを取得します。

### セル参照での使用
A1セルに銘柄コード「4755.T」、B2セルに取得項目「現在値」が入力されている場合：
```excel
=RssMarket(A1, B2)
```

### VWAPの取得
```excel
=RssMarket("4755", "VWAP")
```
楽天株の出来高加重平均価格を取得します。

## 戻り値

### 成功時の出力形式

**データ構造**: 単一セル
- **関数セル**: 指定した取得項目の値

### 実際の出力例

#### 現在値の取得
```excel
=RssMarket("4755", "現在値")
```
結果：`1150` （数値）

#### 銘柄名称の取得
```excel
=RssMarket("4755", "銘柄名称")
```
結果：`楽天グループ` （文字列）

#### VWAPの取得
```excel
=RssMarket("7203", "VWAP")
```
結果：`2485.50` （数値、小数点以下2桁まで）

#### 出来高の取得
```excel
=RssMarket("4755", "出来高")
```
結果：`1250000` （数値、株数）

### 取得項目別の値範囲・形式

| 取得項目 | データ型 | 値の範囲・形式 | 例 | 備考 |
|----------|----------|----------------|-----|------|
| 現在値 | number | 正数（価格）<br>小数点以下は値段単位に依存 | `1150`, `2485.5` | 円単位 |
| 前日終値 | number | 正数（価格） | `1140`, `2480` | 円単位 |
| 始値 | number | 正数（価格） | `1145`, `2490` | 当日始値 |
| 高値 | number | 正数（価格） | `1160`, `2520` | 当日高値 |
| 安値 | number | 正数（価格） | `1135`, `2475` | 当日安値 |
| 出来高 | number | 0以上整数 | `1250000`, `890000` | 株数単位 |
| VWAP | number | 正数（価格） | `1152.75`, `2485.50` | 出来高加重平均価格 |
| 銘柄名称 | string | 全角文字列 | `楽天グループ`, `トヨタ自動車` | 正式銘柄名 |
| 前日比 | number | 実数（±） | `+10`, `-15` | 前日終値からの差額 |
| 前日比率 | number | 実数（%） | `0.88`, `-0.60` | パーセント値（%記号なし） |
| 売気配 | number | 正数または0 | `1149`, `0` | 売り気配値、気配なしは0 |
| 買気配 | number | 正数または0 | `1151`, `0` | 買い気配値、気配なしは0 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銘柄コード無効、取得項目無効、市場休場等
- `#REF!` - セル参照エラー

### 特別なケース

#### 市場休場時
```excel
=RssMarket("4755", "現在値")
```
結果：`#N/A`

#### 無効な銘柄コード
```excel
=RssMarket("9999", "現在値")
```
結果：`#N/A`

#### 無効な取得項目
```excel
=RssMarket("4755", "存在しない項目")
```
結果：`#VALUE!`

#### 気配なし時
```excel
=RssMarket("4755", "売気配")
```
結果：`0` （気配がない場合）

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 銘柄コード、取得項目の形式を確認 |
| #N/A | 銘柄コード無効、市場休場等 | 銘柄コードと市場時間を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssMarketHeader**: 市況情報ヘッダー行作成（取得可能項目一覧表示）
- **RssMarketDes**: 国内株式銘柄情報（売買単位、制限値幅等）
- **RssIndexMarket**: 指数情報取得
- **RssFXMarket**: 為替レート取得

## 注意事項

1. **市場時間**: データは各市場の開場時間に依存します
2. **リアルタイムデータ**: 情報更新頻度はマーケットスピード IIに準拠
3. **銘柄コード形式**: 市場コード（.T、.JAX、.JNX）の指定により異なる市場のデータを取得
4. **取得項目**: 取得可能な項目はRssMarketHeader関数で確認可能
5. **データ型**: 数値データは計算に使用可能、文字列データは表示用

## 市場コード詳細

| 市場コード | 市場名 | 例 |
|------------|--------|-----|
| （省略） | 東京証券取引所 | 4755 |
| .T | 東京証券取引所 | 4755.T |
| .JAX | JASDAQ | 銘柄コード.JAX |
| .JNX | JNX | 銘柄コード.JNX |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「市況情報」