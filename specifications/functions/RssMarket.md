# RssMarket 非公式テスト確認仕様

## 概要
**関数名**: RssMarket  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 国内株式の市況情報取得  

**説明**: 指定された国内株式の個別銘柄の市況情報をExcelに表示します。現在値、始値、高値、安値、出来高、VWAP等のリアルタイム市場データを取得できます。

## 構文 (Syntax)

```excel
RssMarket("銘柄コード", "取得項目")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 銘柄コード | string | 必須 | **英数字4桁(5桁)**: 東証<br>**英数字4桁(5桁).T**: 東証<br>**英数字4桁(5桁).JAX**: JASDAQ<br>**英数字4桁(5桁).JNX**: JNX |
| 2 | 取得項目 | string | 必須 | 市況情報の取得項目名（下記項目表参照） |

## 取得可能項目一覧

### 全148項目（RssMarketHeaderと共通）

#### 基本情報（1-7）
1. 銘柄コード
2. 市場コード
3. 銘柄名称
4. 市場名称
5. 市場部名称
6. 市場部略称
7. 現在日付

#### 現在値情報（8-17）
8. 現在値
9. 現在値時刻
10. 現在値詳細時刻
11. 現在値ティック
12. 現在値フラグ
13. 前日比
14. 前日比率
15. 前日終値
16. 前日日付
17. 前日終値フラグ

#### 歩み値情報（18-25）
18. 歩み1
19. 歩み2
20. 歩み3
21. 歩み4
22. 歩み1詳細時刻
23. 歩み2詳細時刻
24. 歩み3詳細時刻
25. 歩み4詳細時刻

#### 出来高・売買代金（26-29）
26. 出来高
27. 売買代金
28. 出来高加重平均
29. 時価総額

#### 四本値（30-38）
30. 始値
31. 高値
32. 安値
33. 始値時刻
34. 高値時刻
35. 安値時刻
36. 始値詳細時刻
37. 高値詳細時刻
38. 安値詳細時刻

#### 前場・後場情報（39-54）
39. 前場始値
40. 前場高値
41. 前場安値
42. 前場終値
43. 前場出来高
44. 後場始値
45. 後場高値
46. 後場安値
47. 前場始値時刻
48. 前場高値時刻
49. 前場安値時刻
50. 前場終値時刻
51. 前場出来高時刻
52. 後場始値時刻
53. 後場高値時刻
54. 後場安値時刻

#### 気配情報（55-64）
55. 最良売気配値
56. 最良買気配値
57. 最良売気配数量
58. 最良買気配数量
59. 最良売気配時刻
60. 最良買気配時刻
61. 最良売気配詳細時刻
62. 最良買気配詳細時刻
63. 特別売気配フラグ
64. 特別買気配フラグ

#### 信用取引情報（65-85）
65. 信用貸借区分
66. 逆日歩
67. 逆日歩更新日付
68. 信用売残
69. 信用売残前週比
70. 信用買残
71. 信用買残前週比
72. 信用倍率
73. 証金残更新日付
74. 新規貸株
75. 新規融資
76. 返済貸株
77. 返済融資
78. 残高貸株
79. 残高融資
80. 残高差引
81. 前日比貸株
82. 前日比融資
83. 前日比差引
84. 回転日数
85. 貸借倍率

#### 板情報（86-125）
86. 最良売気配値1
87. 最良売気配値2
88. 最良売気配値3
89. 最良売気配値4
90. 最良売気配値5
91. 最良売気配値6
92. 最良売気配値7
93. 最良売気配値8
94. 最良売気配値9
95. 最良売気配値10
96. 最良買気配値1
97. 最良買気配値2
98. 最良買気配値3
99. 最良買気配値4
100. 最良買気配値5
101. 最良買気配値6
102. 最良買気配値7
103. 最良買気配値8
104. 最良買気配値9
105. 最良買気配値10
106. 最良売気配数量1
107. 最良売気配数量2
108. 最良売気配数量3
109. 最良売気配数量4
110. 最良売気配数量5
111. 最良売気配数量6
112. 最良売気配数量7
113. 最良売気配数量8
114. 最良売気配数量9
115. 最良売気配数量10
116. 最良買気配数量1
117. 最良買気配数量2
118. 最良買気配数量3
119. 最良買気配数量4
120. 最良買気配数量5
121. 最良買気配数量6
122. 最良買気配数量7
123. 最良買気配数量8
124. 最良買気配数量9
125. 最良買気配数量10

#### 成行気配（126-129）
126. 売成行数量
127. 買成行数量
128. OVER気配数量
129. UNDER気配数量

#### 銘柄詳細情報（130-148）
130. 単位株数
131. 配当
132. 配当落日
133. 中配落日
134. 権利落日
135. 決算発表日
136. PER
137. PBR
138. 当日基準値
139. 年初来高値
140. 年初来安値
141. 年初来高値日付
142. 年初来安値日付
143. 上場来高値
144. 上場来安値
145. 上場来高値日付
146. 上場来安値日付
147. 貸株金利
148. 貸株金利適用日

## 使用例

### 基本的な使用方法
```excel
=RssMarket("4755.T", "現在値")
```
楽天株の現在値を表示します。

### 複数データの取得
```excel
=RssMarket("7203", "始値")
=RssMarket("7203", "高値")  
=RssMarket("7203", "安値")
=RssMarket("7203", "出来高")
```
トヨタ株の各種市況データを取得します。

### セル参照での使用
A1セルに銘柄コード「4755.T」、B2セルに取得項目「現在値」が入力されている場合：
```excel
=RssMarket(A1, B2)
```

### VWAPの取得
```excel
=RssMarket("4755", "VWAP")
```
楽天株の出来高加重平均価格を取得します。

## 戻り値

### 成功時の出力形式

**データ構造**: 単一セル
- **関数セル**: 指定した取得項目の値

### 実際の出力例

#### 現在値の取得
```excel
=RssMarket("4755", "現在値")
```
結果：`1150` （数値）

#### 銘柄名称の取得
```excel
=RssMarket("4755", "銘柄名称")
```
結果：`楽天グループ` （文字列）

#### VWAPの取得
```excel
=RssMarket("7203", "VWAP")
```
結果：`2485.50` （数値、小数点以下2桁まで）

#### 出来高の取得
```excel
=RssMarket("4755", "出来高")
```
結果：`1250000` （数値、株数）

### 主要項目のデータ型と値範囲

| 取得項目 | データ型 | 値の範囲・形式 | 例 | 備考 |
|----------|----------|----------------|-----|------|
| 現在値 | number/string | 正数（価格）または空文字 | `920.0`, `""` | 市場時間外は空文字 |
| 前日終値 | number/string | 正数（価格）または空文字 | `915.0`, `""` | 前日データなしは空文字 |
| 始値 | number/string | 正数（価格）または空文字 | `918.0`, `""` | 当日始値 |
| 高値 | number/string | 正数（価格）または空文字 | `925.0`, `""` | 当日高値 |
| 安値 | number/string | 正数（価格）または空文字 | `915.0`, `""` | 当日安値 |
| 出来高 | number/string | 0以上整数または空文字 | `1250000`, `""` | 株数単位 |
| 出来高加重平均 | number/string | 正数（価格）または空文字 | `918.75`, `""` | VWAP |
| 銘柄名称 | string | 全角文字列 | `楽天グループ` | 正式銘柄名 |
| 前日比 | number/string | 実数（±）または空文字 | `5.0`, `-3.0`, `""` | 前日終値からの差額 |
| 前日比率 | number/string | 実数（%）または空文字 | `0.55`, `-0.33`, `""` | パーセント値 |
| 最良売気配値 | number/string | 正数または空文字 | `921.0`, `""` | 売り気配値 |
| 最良買気配値 | number/string | 正数または空文字 | `919.0`, `""` | 買い気配値 |
| 歩み1-4 | number/string | 正数または空文字 | `920.0`, `""` | 約定値 |
| 信用売残 | number/string | 0以上整数または空文字 | `125000`, `""` | 株数単位 |
| PER | number/string | 正数または空文字 | `15.5`, `""` | 株価収益率 |
| PBR | number/string | 正数または空文字 | `1.2`, `""` | 株価純資産倍率 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銘柄コード無効、取得項目無効、市場休場等
- `#REF!` - セル参照エラー

### 特別なケース

#### 市場休場時
```excel
=RssMarket("4755", "現在値")
```
結果：`#N/A`

#### 無効な銘柄コード
```excel
=RssMarket("9999", "現在値")
```
結果：`#N/A`

#### 無効な取得項目
```excel
=RssMarket("4755", "存在しない項目")
```
結果：`#VALUE!`

#### 気配なし時
```excel
=RssMarket("4755", "売気配")
```
結果：`0` （気配がない場合）

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 銘柄コード、取得項目の形式を確認 |
| #N/A | 銘柄コード無効、市場休場等 | 銘柄コードと市場時間を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssMarketHeader**: 市況情報ヘッダー行作成（取得可能項目一覧表示）
- **RssMarketDes**: 国内株式銘柄情報（売買単位、制限値幅等）
- **RssIndexMarket**: 指数情報取得
- **RssFXMarket**: 為替レート取得

## 注意事項

1. **市場時間**: データは各市場の開場時間に依存します（市場時間外は多くの項目が空文字列）
2. **リアルタイムデータ**: 情報更新頻度はマーケットスピード IIに準拠
3. **銘柄コード形式**: 市場コード（.T、.JAX、.JNX）の指定により異なる市場のデータを取得
4. **取得項目**: 全148項目が取得可能（RssMarketHeader関数と完全一致）
5. **データ型**: 市場時間内は数値、市場時間外は空文字列として返される場合が多い
6. **項目名の正確性**: 項目名は大文字小文字を含めて正確に指定する必要があります

## 市場コード詳細

| 市場コード | 市場名 | 例 |
|------------|--------|-----|
| （省略） | 東京証券取引所 | 4755 |
| .T | 東京証券取引所 | 4755.T |
| .JAX | JASDAQ | 銘柄コード.JAX |
| .JNX | JNX | 銘柄コード.JNX |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「市況情報」