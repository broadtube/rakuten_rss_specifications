# RssFOPOrderList 完全仕様書

## 概要
**関数名**: RssFOPOrderList  
**カテゴリ**: 先物OP注文管理 (Futures & Options Order Management)  
**用途**: 先物OP注文一覧の取得  

**説明**: 先物・オプション取引の注文一覧を取得してExcelに表示します。未約定注文、約定済み注文、取消済み注文などの状況を一覧で確認でき、先物・オプション取引の注文管理に活用できます。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssFOPOrderList(引数列, ヘッダ行)
```

### VBA関数
```vb
RssFOPOrderList_V(引数列, ヘッダ行)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 引数列 | ● | number | データ列の開始位置を指定する数値 |
| 2 | ヘッダ行 | ● | number | ヘッダ行の位置を指定する数値 |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な先物OP注文一覧取得
```excel
=RssFOPOrderList(A1, 1)
```
先物OP注文一覧をA1から表示、1行目にヘッダを配置

### 他の位置での注文一覧表示
```excel
=RssFOPOrderList(C5, 6)
```
先物OP注文一覧をC5から表示、6行目にヘッダを配置

## 戻り値

### 成功時の出力形式

**データ構造**: マトリクス形式（配列）
- **ヘッダ行**: 項目名
- **データ行**: 各注文の詳細情報

### 実際の出力例

#### 先物OP注文一覧の出力
```excel
=RssFOPOrderList(A1, 1)
```

| 注文番号 | 注文区分 | 商品種別 | 銘柄コード | 銘柄名 | 売買区分 | 注文数量 | 注文価格 | 執行条件 | 注文状況 | 約定数量 | 約定価格 | 注文日時 | 有効期限 |
|----------|----------|----------|-----------|--------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| F2024050800001 | 通常 | 先物 | NK225M | 日経225先物 | 買 | 1 | 38500 | 本日中 | 未約定 | 0 | 0 | 20240508 09:00:00 | 20240508 |
| F2024050800002 | 通常 | OP | NK225OP240508C38000 | 日経225OP | 売 | 10 | 150 | 今週中 | 一部約定 | 5 | 150 | 20240508 10:30:00 | 20240510 |
| F2024050700003 | 逆指値 | 先物 | TOPIXM | TOPIX先物 | 売 | 1 | 成行 | 本日中 | 約定済 | 1 | 2750 | 20240507 14:00:00 | 20240507 |

### データ項目の詳細

| 項目 | データ型 | 説明 |
|------|----------|------|
| 注文番号 | string | 注文を一意に識別する番号（例：F2024050800001） |
| 注文区分 | string | 通常/逆指値/逆指値付通常 |
| 商品種別 | string | 先物/OP（オプション） |
| 銘柄コード | string | 先物・オプションの銘柄コード |
| 銘柄名 | string | 銘柄の正式名称 |
| 売買区分 | string | 買/売 |
| 注文数量 | number | 注文した枚数 |
| 注文価格 | variant | 指値価格または「成行」 |
| 執行条件 | string | 本日中/今週中/寄付/引け/期間指定/大引不成/不成 |
| 注文状況 | string | 未約定/一部約定/約定済/取消済/失効 |
| 約定数量 | number | 約定済みの枚数 |
| 約定価格 | number | 約定価格（平均約定価格） |
| 注文日時 | string | 注文を発注した日時（YYYY/MM/DD HH:MM:SS） |
| 有効期限 | string | 注文の有効期限（YYYY/MM/DD） |

### 先物OP注文番号の形式

| 項目 | 形式 | 例 | 説明 |
|------|------|-----|------|
| 注文番号 | string | `F` + `YYYYMMDD` + 5桁連番 | `F2024050800001` |
| プレフィックス | string | `F` | 先物OP取引識別コード |
| 日付部分 | string | `YYYYMMDD` | 発注日（年月日） |
| 連番部分 | string | 5桁数字 | 日内連続番号 |

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、先物OP口座未開設 | ログイン状況、口座開設状況を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssFOPExecutionList**: 先物OP約定一覧
- **RssFOPPositionList**: 先物OP建玉一覧
- **RssFOPOpenOrder**: 先物OP新規注文
- **RssFOPModifyOrder**: 先物OP注文訂正
- **RssFOPCancelOrder**: 先物OP注文取消

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年