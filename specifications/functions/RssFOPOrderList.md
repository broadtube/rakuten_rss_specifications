# RssFOPOrderList 非公式テスト確認仕様

## 概要
**関数名**: RssFOPOrderList  
**カテゴリ**: 先物OP注文管理 (Futures & Options Order Management)  
**用途**: 先物OP注文一覧の取得  

**説明**: 先物オプション注文の注文一覧を表示します。未約定注文、約定済み注文、取消済み注文などの状況を一覧で確認でき、先物・オプション取引の注文管理に活用できます。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssFOPOrderList(ヘッダー行, 注文状況, 銘柄種類, 取引種類)
```

### VBA関数
```vb
RssFOPOrderList_V(ヘッダー行, 注文状況, 銘柄種類, 取引種類)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | ヘッダー行 | △ | セル参照 | 取得項目が入力されているセル範囲を指定します<br>省略時はすべての取得項目を表示します |
| 2 | 注文状況 | △ | 数値 | 0:全て、1:訂正取消可能注文、2:執行待ち、3:執行中、4:出来有、5:約定、6:取消中（出来有）、7:取消中（出来無）、8:取消済（出来無）、9:取消済（出来有）、10:出来ず（出来有）、11:出来ず（出来無）、12:訂正済、13:-（逆指値･アルゴ）<br>省略時は「0」として扱います |
| 3 | 銘柄種類 | △ | 文字列/数値 | 0:全て、F:指数先物全て、C:商品先物全て、N225F:日経225先物、N225MF:日経225ミニ、MOTF:東証マザーズ指数先物、N225OP:日経225オプション、N225C:日経225オプション コール、N225P:日経225オプション プット、GOLDF:金、GOLDMINIF:金ミニ、GOLDSPOTF:金スポット、PLATINUMF:白金、PLATINUMMINIF:白金ミニ、PLATINUMSPOTF:白金スポット、SILVERF:銀、PALLADIUMF:パラジウム、RSS3F:ゴム(RSS3)、TSR20F:ゴム(TSR20)、REDBEANF:小豆、SOYBEANF:一般大豆、CORNF:とうもろこし<br>省略時は「0」として扱います |
| 4 | 取引種類 | △ | 数値 | 0:全て、1:買建、2:売建、3:買埋、4:売埋<br>省略時は「0」として扱います |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な先物OP注文一覧取得（全て表示）
```excel
=RssFOPOrderList()
```
全ての先物OP注文を表示（全パラメータ省略）

### ヘッダー行指定での取得
```excel
=RssFOPOrderList(A1:K1)
```
A1:K1セルにヘッダー項目を設定して、必要な項目のみを取得

### 未約定注文のみ取得
```excel
=RssFOPOrderList(, 2)
```
執行待ち（未約定）の注文のみを表示

### 日経225先物の注文のみ取得
```excel
=RssFOPOrderList(, 0, "N225F")
```
日経225先物の全注文を表示

### 買建注文のみ取得
```excel
=RssFOPOrderList(, 0, 0, 1)
```
全銘柄の買建注文のみを表示

### 複合条件での取得
```excel
=RssFOPOrderList(A1:K1, 2, "N225F", 1)
```
日経225先物の執行待ち買建注文のみを表示

## 戻り値

### 成功時の出力形式

**データ構造**: 一覧形式
- **ヘッダー行**: 項目名（省略時は自動生成）
- **データ行**: 各注文の詳細情報

### 出力項目

| No | 項目名 | データ型 | 説明 |
|----|--------|----------|------|
| 1 | 注文番号 | string | 注文番号を表示 |
| 2 | 受付No | string | 受付Noを表示 |
| 3 | 通常注文状況 | string | 通常注文の注文状況を表示（執行待ち、執行中、出来有、約定、取消中（出来有）、取消中（出来無）、取消済（出来有）、取消済（出来無）、出来ず（出来有）、出来ず（出来無）、訂正済） |
| 4 | 逆指値注文状況 | string | 逆指値注文の注文状況を表示（受付、待機中、市場執行中、取消済） |
| 5 | 銘柄コード | string | 証券コード協議会で定められた銘柄コードを表示 |
| 6 | 銘柄名称 | string | 銘柄名称を表示 |
| 7 | 市場名称 | string | 市場を表示（大阪:大阪取引所） |
| 8 | 発注・受注日時 | string | 発注・受注の日時を表示（YYYY/MM/DD HH:MM） |
| 9 | セッション区分 | string | どちらのセッションで発注されたかを表示（日中、夜間） |
| 10 | 取引 | string | 取引内容を表示（買建、買埋、売建、売埋） |
| 11 | 注文数量 | number | 注文数量を表示 |
| 12 | 執行条件 | string | 執行条件を表示 |
| 13 | 注文値段 | string/number | 注文価格を表示（成行の場合は「成行」） |
| 14 | 約定数量 | number | 約定済みの数量を表示 |
| 15 | 約定値段 | number | 約定価格を表示（平均約定価格） |
| 16 | 注文有効期限 | string | 注文の有効期限を表示 |
| 17 | トリガー条件 | string | 逆指値等のトリガー条件を表示 |
| 18 | トリガー価格 | number | トリガー価格を表示 |

### 実際の出力例

#### 全注文の一覧
```excel
=RssFOPOrderList()
```
結果：
```
注文番号    受付No    通常注文状況    逆指値注文状況    銘柄コード    銘柄名称          市場名称    発注・受注日時        セッション区分    取引    注文数量
F00001      12345    執行待ち        -                N225F        日経225先物3月限  大阪        2024/12/01 09:00     日中            買建    1
F00002      12346    約定           -                N225OP2412C38000  日経225OP    大阪        2024/12/01 09:30     日中            売建    10
F00003      12347    取消済(出来無)  -                GOLDF        金先物2月限      大阪        2024/12/01 10:15     日中            買建    1
```

#### 執行待ち注文のみ
```excel
=RssFOPOrderList(, 2)
```
結果：
```
注文番号    受付No    通常注文状況    逆指値注文状況    銘柄コード    銘柄名称          市場名称    発注・受注日時        セッション区分    取引    注文数量
F00001      12345    執行待ち        -                N225F        日経225先物3月限  大阪        2024/12/01 09:00     日中            買建    1
```

### 失敗時の出力

**可能なエラー**:
- `ヘッダー行に有効な項目名が存在しません。` - ヘッダー行に正しい項目名がない
- `ヘッダー行は、単一行のセル範囲で入力してください。` - ヘッダー行形式エラー
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - ログインエラー、先物OP口座未開設

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| ヘッダー行に有効な項目名が存在しません | ヘッダー行に正しい項目名がない | 正しい項目名を指定 |
| ヘッダー行は、単一行のセル範囲で入力してください | ヘッダー行形式エラー | 単一行のセル範囲を指定 |
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、先物OP口座未開設 | ログイン状況、口座開設状況を確認 |

## 活用例

### 注文状況の監視
```excel
// A1に関数を配置
=RssFOPOrderList()

// 執行待ち注文の数をカウント
=COUNTIF(C:C,"執行待ち")
```

### 銘柄別注文管理
```excel
// 日経225先物の注文のみ
=RssFOPOrderList(, 0, "N225F")

// 日経225オプションの注文のみ
=RssFOPOrderList(, 0, "N225OP")
```

### VBAでの活用
```vb
Sub CheckFOPOrders()
    Dim orderData As Variant
    
    ' 執行待ち注文のみ取得
    orderData = Application.WorksheetFunction.RssFOPOrderList_V(, 2)
    
    ' 執行待ち注文をチェック
    Dim i As Long
    For i = 2 To UBound(orderData, 1)
        If orderData(i, 3) = "執行待ち" Then
            MsgBox "注文番号 " & orderData(i, 1) & " が執行待ちです"
        End If
    Next i
End Sub
```

## 関連関数
- **RssFOPExecutionList**: 先物OP約定一覧
- **RssFOPPositionList**: 先物OP建玉一覧
- **RssFOPOpenOrder**: 先物OP新規注文
- **RssFOPCloseOrder**: 先物OP決済注文
- **RssFOPModifyOrder**: 先物OP注文訂正
- **RssFOPCancelOrder**: 先物OP注文取消

## 注意事項

1. **自動更新なし**: この関数は自動更新対象外です（-）
2. **ログイン必要**: 楽天証券へのログインが必要です
3. **先物OP口座必要**: 先物・オプション取引口座の開設が必要です
4. **注文状況のリアルタイム性**: 注文状況は市場の状態により随時変化します
5. **銘柄種類の指定**: 銘柄種類は文字列または数値で指定可能です
6. **パラメータの省略**: 全パラメータが省略可能で、省略時は全データを表示します
7. **項目名の正確性**: ヘッダー行を指定する場合は項目名を正確に入力する必要があります

## パラメータの説明

### 注文状況
- 0: 全て（デフォルト）
- 1: 訂正取消可能注文（訂正・取消が可能な注文）
- 2: 執行待ち（市場に発注される前の状態）
- 3: 執行中（市場で執行中）
- 4-13: 各種約定・取消状態

### 銘柄種類
- 指数先物、商品先物、オプションなど多様な銘柄種類を指定可能
- 文字列コード（N225F等）または数値（0）で指定

### 取引種類
- 買建: 新規買いポジション
- 売建: 新規売りポジション
- 買埋: 売りポジションの決済
- 売埋: 買いポジションの決済

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF