# RssFOPPositionList 完全仕様書

## 概要
**関数名**: RssFOPPositionList  
**カテゴリ**: 先物OP建玉管理 (Futures & Options Position Management)  
**用途**: 先物OP建玉一覧の取得  

**説明**: 現在保有している先物・オプション建玉の一覧をExcelに表示します。建玉数量、評価損益、必要証拠金等の情報を取得でき、先物・オプション取引のリスク管理に活用できます。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssFOPPositionList(引数列, ヘッダ行)
```

### VBA関数
```vb
RssFOPPositionList_V(引数列, ヘッダ行)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 引数列 | ● | number | データ列の開始位置を指定する数値 |
| 2 | ヘッダ行 | ● | number | ヘッダ行の位置を指定する数値 |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な先物OP建玉一覧取得
```excel
=RssFOPPositionList(A1, 1)
```
先物OP建玉一覧をA1から表示、1行目にヘッダを配置

### 他の位置での建玉一覧表示
```excel
=RssFOPPositionList(E2, 3)
```
先物OP建玉一覧をE2から表示、3行目にヘッダを配置

## 戻り値

### 成功時の出力形式

**データ構造**: マトリクス形式（配列）
- **ヘッダ行**: 項目名
- **データ行**: 各建玉の詳細情報

### 実際の出力例

#### 先物OP建玉一覧の出力
```excel
=RssFOPPositionList(A1, 1)
```

| 建玉番号 | 商品種別 | 銘柄コード | 銘柄名 | 売買区分 | 建玉数量 | 建玉価格 | 現在価格 | 評価損益 | 必要証拠金 | 建玉日 | 決済期日 |
|----------|----------|-----------|--------|----------|----------|----------|----------|----------|----------|--------|----------|
| P2024050800001 | 先物 | NK225M | 日経225先物 | 買 | 1 | 38450 | 38600 | 150000 | 1540000 | 20240508 | 20240613 |
| P2024050800002 | OP | NK225OP240508C38000 | 日経225OP | 売 | 5 | 150 | 120 | 15000 | 0 | 20240508 | 20240508 |
| P2024050700003 | 先物 | TOPIXM | TOPIX先物 | 売 | 1 | 2750 | 2730 | 200000 | 1370000 | 20240507 | 20240613 |

### データ項目の詳細

| 項目 | データ型 | 説明 |
|------|----------|------|
| 建玉番号 | string | 建玉を一意に識別する番号 |
| 商品種別 | string | 先物/OP（オプション） |
| 銘柄コード | string | 先物・オプションの銘柄コード |
| 銘柄名 | string | 銘柄の正式名称 |
| 売買区分 | string | 買/売 |
| 建玉数量 | number | 現在の建玉枚数 |
| 建玉価格 | number | 平均建玉価格 |
| 現在価格 | number | 最新の市場価格 |
| 評価損益 | number | (現在価格-建玉価格)×建玉数量×乗数 |
| 必要証拠金 | number | 建玉維持に必要な証拠金額 |
| 建玉日 | string | 建玉を取得した日（YYYY/MM/DD） |
| 決済期日 | string | 決済期限（先物）または満期日（OP） |

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、先物OP口座未開設 | ログイン状況、口座開設状況を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssFOPOrderList**: 先物OP注文一覧
- **RssFOPExecutionList**: 先物OP約定一覧
- **RssFOPCloseOrder**: 先物OP決済注文
- **RssFOPCapacityList**: 先物OP余力情報

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年