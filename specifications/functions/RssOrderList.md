# RssOrderList 非公式テスト確認仕様

## 概要
**関数名**: RssOrderList  
**カテゴリ**: 注文管理 (Order Management)  
**用途**: 国内株式注文一覧の取得  

**説明**: 国内株式の注文一覧を取得してExcelに表示します。未約定注文、約定済み注文、取消済み注文などの状況を一覧で確認できます。注文の詳細情報や注文番号を取得して、注文管理に活用できます。表示されるデータは当日分のみのデータとなります。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssOrderList(ヘッダー行, 注文状況, 注文種類, 銘柄コード, 口座区分, 売買, 信用取引, 信用区分, アルゴ注文, アルゴ注文種類)
```

### VBA関数
```vb
RssOrderList_V(ヘッダー行, 注文状況, 注文種類, 銘柄コード, 口座区分, 売買, 信用取引, 信用区分, アルゴ注文, アルゴ注文種類)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | ヘッダー行 | △ | セル参照 | 取得項目が入力されているセル範囲を指定します。省略時はすべての取得項目を表示します |
| 2 | 注文状況 | △ | 数値 | フィルタリング条件 |
| 3 | 注文種類 | △ | 数値 | フィルタリング条件 |
| 4 | 銘柄コード | △ | 文字列 | 特定銘柄に絞り込み |
| 5 | 口座区分 | △ | 文字列 | 口座種類の指定 |
| 6 | 売買 | △ | 数値 | 売買区分の指定 |
| 7 | 信用取引 | △ | 数値 | 信用取引区分の指定 |
| 8 | 信用区分 | △ | 数値 | 信用期間の指定 |
| 9 | アルゴ注文 | △ | 数値 | アルゴ注文の包含指定 |
| 10 | アルゴ注文種類 | △ | 数値 | アルゴ注文種類の指定 |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

### パラメータ値の詳細

#### 注文状況 (パラメータ2)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | 訂正取消可能注文 |
| 2 | 執行待ち |
| 3 | 執行中 |
| 4 | 出来有 |
| 5 | 約定 |
| 6 | 取消中（出来有） |
| 7 | 取消中（出来無） |
| 8 | 取消済（出来無） |
| 9 | 取消済（出来有） |
| 10 | 出来ず（出来有） |
| 11 | 出来ず（出来無） |
| 12 | 訂正済 |
| 13 | -（逆指値・アルゴ） |

#### 注文種類 (パラメータ3)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | 現物 |
| 2 | 信用 |

#### 口座区分 (パラメータ5)
| 値 | 意味 |
|----|------|
| "A" または省略 | 全て |
| "0" | 特定 |
| "1" | 一般 |
| "2" | NISA（NISA成長投資枠） |
| "3" | 旧NISA |

#### 売買 (パラメータ6)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | 売 |
| 3 | 買 |

#### 信用取引 (パラメータ7)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | 信用新規 |
| 2 | 信用返済 |
| 3 | 現引 |
| 4 | 現渡 |

#### 信用区分 (パラメータ8)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | 制度（6ヶ月） |
| 2 | 一般（無期限） |
| 3 | 一般（14日） |
| 4 | 一般（1日） |

#### アルゴ注文 (パラメータ9)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | アルゴ注文含まず |
| 2 | アルゴ注文のみ |

#### アルゴ注文種類 (パラメータ10)
| 値 | 意味 |
|----|------|
| 0 または省略 | 全て |
| 1 | アイスバーグ |
| 2 | スナイパー |
| 3 | トレイリング |
| 4 | リザーブ |
| 5 | リンク |

## 使用例

### 基本的な注文一覧取得
```excel
=RssOrderList()
```
A1セル（1行目）に関数を入力すると、2行目から注文一覧を表示します。注文一覧は2行目の出力項目（ヘッダ行）と、それ以降の注文詳細で構成されます。

### 全ての項目を表示する場合
```excel
=RssOrderList($A$2:$AD$2)
```
入力後の関数には出力項目のリスト（ヘッダ）が引数として渡され、=RssOrderList($A$2:$AD$2)と書き換わります。

### 特定銘柄の注文のみ表示
```excel
=RssOrderList($A$2:$AD$2,0,0,4755,"A",0,,,,0)
=RssOrderList($A$2:$AD$2,0,0,"4755.T","A",0,,,,0)
```
楽天グループ（4755）の注文詳細のみを表示します。銘柄コードは4桁の数値または"4755.T"形式で指定可能です。

### 未約定注文のみ表示
```excel
=RssOrderList($A$2:$AD$2,1)
```
訂正取消可能注文（未約定）のみを表示します。

### 信用取引の注文のみ表示
```excel
=RssOrderList($A$2:$AD$2,0,2)
```
信用取引の注文のみを表示します。

### 特定口座区分の注文表示
```excel
=RssOrderList($A$2:$AD$2,0,0,"","2")
```
NISA口座の注文のみを表示します。

### 売り注文のみ表示
```excel
=RssOrderList($A$2:$AD$2,0,0,"","A",1)
```
売り注文のみを表示します。

### アルゴ注文のみ表示
```excel
=RssOrderList($A$2:$AD$2,0,0,"","A",0,,,,2)
```
アルゴ注文のみを表示します。

### 複合条件での絞り込み
```excel
=RssOrderList($A$2:$AD$2,1,1,"","1",3)
```
一般口座の現物買い注文で、訂正取消可能な注文のみを表示します。

## 戻り値

### 成功時の出力形式

**データ構造**: マトリクス形式（配列）
- **ヘッダ行**: 項目名
- **データ行**: 各注文の詳細情報

### 実際の出力例

#### 注文一覧の出力
```excel
=RssOrderList()
```

| 注文番号 | 受付No | 通常注文状況 | 逆指値注文状況 | アルゴ注文状況 | 銘柄コード | 銘柄名称 | 口座区分 | 市場名称 | 信用区分 | 弁済期間 | 発注/受注日時 | 売買 | 取引 |
|----------|--------|--------------|----------------|--------------|-----------|----------|----------|----------|----------|----------|-------------|------|------|
| S2024050800001 | 202405080001 | 執行待ち | | | 4755 | 楽天グループ | 一般 | 東証 | | | 2024/05/08 09:00 | 買付 | 現物 |
| S2024050800002 | 202405080002 | 一部約定 | | | 7203 | トヨタ自動車 | 一般 | 東証 | | | 2024/05/08 10:30 | 売付 | 現物 |
| S2024050700003 | 202405070003 | 約定 | | | 9984 | SBG | 一般 | 東証 | | | 2024/05/07 14:00 | 買付 | 現物 |

## 出力項目の完全リスト

### 基本情報項目
| No | 項目名 | データ型 | 説明 |
|----|--------|----------|------|
| 1 | 注文番号 | string | 注文を一意に識別する番号 |
| 2 | 受付No | string | 受付番号を表示 |
| 3 | 通常注文状況 | string | 通常注文の注文状況を表示（執行待ち、執行中、出来待、約定、取消中（出来待）、取消中（出来無）、取消済（出来無）、取消済（出来待）、出来切（出来待）、出来切（出来無）、訂正済） |
| 4 | 逆指値注文状況 | string | 逆指値注文の注文状況を表示（受付、待機中、市場執行中、取消済） |
| 5 | アルゴ注文状況 | string | アルゴ注文の注文状況を表示（監視中、執行済、取消済、出来切） |
| 6 | 銘柄コード | string | 証券コード協議会で定められた銘柄コードを表示 |
| 7 | 銘柄名称 | string | 銘柄名称を表示 |
| 8 | 口座区分 | string | 口座区分を表示（一般、特定、旧NISA、NISA（NISA成長投資枠）） |
| 9 | 市場名称 | string | 市場を表示（東証、東証（東証、東証（SOR））：東証でSOR有効時、JAX：JAX、JNX：JNX） |
| 10 | 信用区分 | string | 信用区分を表示（制度、一般） |
| 11 | 弁済期間 | string | 弁済期間を表示（6ヶ月、無期限、14日、1日） |
| 12 | 発注/受注日時 | datetime | 注文の受注日時次を表示（YYYY/MM/DD HH:MM） |
| 13 | 売買 | string | 売買を表示（買付、買建、買回、売付、売建、売回） |
| 14 | 取引 | string | 取引内容を表示（現物、信用新規、信用返済） |

### 注文詳細項目
| No | 項目名 | データ型 | 説明 |
|----|--------|----------|------|
| 15 | 注文数量 | number | 注文数量を表示 |
| 16 | 注文価格 | variant | 注文価格を表示（指値価格または「成行」） |
| 17 | 執行条件 | string | 執行条件を表示 |
| 18 | 注文期間 | string | 注文期間を表示 |
| 19 | 約定数量 | number | 約定数量を表示 |
| 20 | 約定価格 | number | 約定価格（加重平均）を表示 |
| 21 | 未約定数量 | number | 未約定数量を表示 |
| 22 | 建玉日 | date | 建玉日を表示 |
| 23 | 建単価 | number | 建単価を表示 |
| 24 | 建市場 | string | 建市場を表示 |
| 25 | 逆指値条件価格 | number | 逆指値条件価格を表示 |
| 26 | 逆指値条件区分 | string | 逆指値条件区分を表示 |
| 27 | 逆指値価格区分 | string | 逆指値価格区分を表示 |
| 28 | 逆指値価格 | number | 逆指値価格を表示 |
| 29 | セット注文価格区分 | string | セット注文の価格区分を表示 |
| 30 | セット注文価格 | number | セット注文価格を表示 |

**注**: 実際の出力項目数は30項目を超える場合があります。HTMLドキュメントによると、最大で$AD列（30項目）まで出力される場合があります。

### 主要データ項目の詳細

| 項目 | データ型 | 説明 |
|------|----------|------|
| 注文番号 | string | 注文を一意に識別する番号（例：S2024050800001） |
| 通常注文状況 | string | 執行待ち/執行中/出来待/約定/取消中/取消済/出来切/訂正済 |
| 銘柄コード | string | 4-5桁の銘柄コード |
| 銘柄名称 | string | 銘柄の正式名称 |
| 売買 | string | 買付/売付/買建/売建/買回/売回 |
| 注文数量 | number | 注文した株数 |
| 注文価格 | variant | 指値価格または「成行」 |
| 執行条件 | string | 本日中/今週中/寄付/引け/期間指定/大引不成/不成 |
| 約定数量 | number | 約定済みの株数 |
| 約定価格 | number | 約定価格（加重平均約定価格） |
| 発注/受注日時 | string | 注文を発注した日時（YYYY/MM/DD HH:MM） |
| 口座区分 | string | 一般/特定/NISA/旧NISA |
| 取引 | string | 現物/信用新規/信用返済 |

### 注文状況の詳細

| 状況 | 説明 | 特徴 |
|------|------|------|
| 未約定 | まだ約定していない注文 | 約定数量=0 |
| 一部約定 | 注文数量の一部が約定済み | 0 < 約定数量 < 注文数量 |
| 約定済 | 注文数量すべてが約定済み | 約定数量 = 注文数量 |
| 取消済 | 取消操作により無効になった注文 | 取消処理完了 |
| 失効 | 有効期限切れで無効になった注文 | 期限切れによる自動取消 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - ログインエラー、サービス利用不可
- `#REF!` - セル参照エラー

### 特別なケース

#### 注文がない場合
```excel
=RssOrderList(A1, 1)
```
結果：ヘッダ行のみ表示、データ行なし

#### システムメンテナンス中
```excel
=RssOrderList(A1, 1)
```
結果：`#N/A`

#### ログインしていない状態
```excel
=RssOrderList(A1, 1)
```
結果：`#N/A`

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、サービス利用不可 | ログイン状況、サービス状況を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssExecutionList**: 約定一覧取得
- **RssOrderStatus**: 特定注文の状況確認
- **RssOrderIDList**: 発注ID一覧取得
- **RssModifyOrder**: 注文訂正
- **RssCancelOrder**: 注文取消

## 制限事項と注意点

### データに関する制限事項
1. **データ範囲**: 表示されるデータは当日分のみのデータとなります
2. **リアルタイム更新**: 注文状況はリアルタイムで更新されます
3. **表示順序**: 通常は注文日時の新しい順で表示されます

### 機能的制限事項
1. **ログイン必要**: 楽天証券へのログインが必要です
2. **サービス時間**: 市場開場時間およびシステムメンテナンス時間外での利用
3. **銘柄コード形式**: 4桁または5桁の英数字、市場コードなしまたは"銘柄.T"形式

### セキュリティ注意事項
1. **口座情報保護**: 口座情報を含むため取り扱いに注意してください
2. **データ機密性**: 注文情報は機密性の高い情報です
3. **アクセス制限**: 適切なアクセス制限を実施してください

### パフォーマンス注意事項
1. **データ量**: 注文数が多い場合、処理に時間がかかる場合があります
2. **フィルタリング推奨**: 大量データの場合は適切なフィルタリングを使用してください
3. **定期更新**: 頻繁な更新は避け、必要に応じて手動更新を行ってください

## データ活用例

### 注文管理
- 未約定注文の確認と管理
- 約定状況のリアルタイム監視
- 注文履歴の詳細分析
- 注文状況別での絞り込み表示

### 自動化処理
- 注文番号の自動取得（RssModifyOrder、RssCancelOrderで使用）
- 約定確認の自動化処理
- ポートフォリオ管理システムとの連携
- アルゴ注文の監視と制御

### レポート作成と分析
- 日次売買履歴の集計
- 銘柄別注文パフォーマンス分析
- 口座別取引状況の把握
- 信用取引ポジション管理
- 税務処理用データの準備

### リスク管理
- 注文状況の一元監視
- 未約定注文の管理
- 信用取引ポジションの監視
- 口座区分別リスク管理

## 注文状況の詳細分類

### 通常注文状況の詳細
| 状況 | 説明 | 特徴 |
|------|------|------|
| 執行待ち | 市場に未送信の注文 | 訂正・取消可能 |
| 執行中 | 市場で執行処理中の注文 | 約定待ち状態 |
| 出来待 | 部分約定後の残数量待機中 | 一部約定済み |
| 約定 | 全数量約定完了 | 約定数量 = 注文数量 |
| 取消中（出来待） | 一部約定後の取消処理中 | 残数量取消中 |
| 取消中（出来無） | 未約定注文の取消処理中 | 約定数量 = 0 |
| 取消済（出来無） | 未約定での取消完了 | 約定なしで終了 |
| 取消済（出来待） | 一部約定後の取消完了 | 一部約定で終了 |
| 出来切（出来待） | 一部約定での期限切れ | 自動失効 |
| 出来切（出来無） | 未約定での期限切れ | 約定なしで失効 |
| 訂正済 | 注文訂正が完了 | 訂正処理完了 |

### 逆指値注文状況の詳細
| 状況 | 説明 | 特徴 |
|------|------|------|
| 受付 | 逆指値注文受付完了 | 監視待機状態 |
| 待機中 | 条件価格監視中 | トリガー待ち |
| 市場執行中 | 条件達成後の市場送信中 | 通常注文化 |
| 取消済 | 逆指値注文取消完了 | 監視終了 |

### アルゴ注文状況の詳細
| 状況 | 説明 | 特徴 |
|------|------|------|
| 監視中 | アルゴリズム実行中 | 自動執行中 |
| 執行済 | アルゴ注文完了 | 全数量処理完了 |
| 取消済 | アルゴ注文取消完了 | アルゴ処理中断 |
| 出来切 | アルゴ注文期限切れ | タイムアウト |

### アルゴ注文種類の詳細
| 種類 | 説明 | 用途 |
|------|------|------|
| アイスバーグ | 大口注文を小口に分割して実行 | 市場インパクト軽減 |
| スナイパー | 最良気配での約定を狙う注文 | 有利な価格での約定 |
| トレイリング | 市場価格に追従する注文 | 利益確保・損失限定 |
| リザーブ | 一定数量のみ市場に表示 | 注文の隠蔽 |
| リンク | 複数注文の連動実行 | 戦略的注文実行 |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF