# RssTickList 完全仕様書

## 概要
**関数名**: RssTickList  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 歩み値データの取得  

**説明**: 指定した国内株式、先物OPの歩み値を表示します。約定時刻、出来高、約定値の履歴データをリアルタイムで取得できます。

## 構文 (Syntax)

```excel
RssTickList(ヘッダー行, "銘柄コード", 表示本数)
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | ヘッダー行 | セル参照 | 任意 | 取得項目をセル範囲で指定。範囲指定は1行のみ（A1:C1形式）<br>省略時は全ての出力項目を表示 |
| 2 | 銘柄コード | string | 必須 | **国内株式**<br>英数字4桁(5桁): 東証<br>英数字4桁(5桁).T: 東証<br>英数字4桁(5桁).JAX: JASDAQ<br>英数字4桁(5桁).JNX: JNX<br>**先物OP**<br>9桁: 国内先物OP |
| 3 | 表示本数 | number | 必須 | 1～300（表示する歩み値の件数） |

## 主要な出力項目

歩み値データには以下の項目が含まれます：

| No | 項目名 | 説明 | データ型 |
|----|--------|------|----------|
| 1 | 時刻 | 約定時刻（HH:MM:SS形式） | time |
| 2 | 出来高 | 約定株数・枚数 | number |
| 3 | 約定値 | 約定価格 | number |

## 使用例

### 基本的な使用方法
```excel
=RssTickList(, "4755.T", 300)
```
A1セルに入力すると、楽天株のティックデータ（時刻、出来高、約定値）を直近から300本表示します。

### ヘッダー行を指定した取得
```excel
=RssTickList($A$2:$C$2, "7203", 100)
```
2行目をヘッダーとして使用し、トヨタ株の歩み値を100本表示します。

### 少数データの取得
```excel
=RssTickList(, "4755", 10)
```
楽天株の直近10件の歩み値を表示します。

### 先物OPの歩み値
```excel
=RssTickList(, "165120018", 50)
```
先物OPの歩み値を50本表示します。

## 戻り値

### 成功時の出力形式

**データ構造**: 多列連続セル出力
- **関数セル**: 全項目が表示された場合のヘッダー行
- **第2行以降**: 歩み値データ（最新から古い順）

### 実際の出力例

#### 基本的な歩み値取得（全10件）
```excel
=RssTickList(, "4755", 10)
```

**出力結果**:
| 行 | 時刻 | 出来高 | 約定値 |
|-----|------|--------|--------|
| 1(関数) | 時刻 | 出来高 | 約定値 |
| 2 | 15:00:00 | 2000 | 1155 |
| 3 | 14:59:55 | 1000 | 1154 |
| 4 | 14:59:50 | 500 | 1155 |
| 5 | 14:59:45 | 3000 | 1156 |
| 6 | 14:59:40 | 800 | 1155 |
| 7 | 14:59:35 | 1500 | 1154 |
| 8 | 14:59:30 | 1200 | 1155 |
| 9 | 14:59:25 | 600 | 1154 |
| 10 | 14:59:20 | 900 | 1155 |
| 11 | 14:59:15 | 2500 | 1156 |

#### ヘッダー指定で時刻のみ取得
```excel
=RssTickList($A$1:$A$1, "7203", 5)
```

**出力結果** (時刻のみ):
| 行 | 時刻 |
|-----|------|
| 1(関数) | 時刻 |
| 2 | 15:00:00 |
| 3 | 14:59:58 |
| 4 | 14:59:55 |
| 5 | 14:59:52 |
| 6 | 14:59:50 |

### 出力項目別の値範囲・形式

| 項目名 | データ型 | 値の範囲・形式 | 例 | 備考 |
|--------|----------|----------------|-----|------|
| 時刻 | time/string | HH:MM:SS形式<br>09:00:00-15:00:00 | `14:30:15`, `09:00:03` | 24時間表記 |
| 出来高 | number | 1以上整数<br>株数・枚数単位 | `100`, `5000`, `50000` | 約定数量 |
| 約定値 | number | 正数（価格）<br>小数点以下は銀柄に依存 | `1150`, `2485.5`, `125` | 円・枚単位 |

### 銀柄別の特徴

| 銀柄タイプ | 時刻範囲 | 出来高範囲 | 約定値範囲 | 特徴 |
|------------|----------|-------------|-------------|------|
| 主要銀柄 | 09:00:00-15:00:00 | 100-100000株 | 100-10000円 | 取引時間中は連続更新 |
| 中小型銀柄 | 09:00:00-15:00:00 | 100-10000株 | 100-5000円 | 約定頻度が低い |
| JASDAQ銀柄 | 09:00:00-15:00:00 | 100-5000株 | 10-1000円 | 小口約定が中心 |
| 先物OP | 09:00:00-15:15:00 | 1-1000枚 | 10000-50000円 | 枚数単位 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銀柄コード無効、データなし
- `#NUM!` - 表示本数の範囲外
- `#REF!` - セル参照エラー

### 特別なケース

#### 市場開始前・終了後
```excel
=RssTickList(, "4755", 10)  // 8:00に実行
```
結果：前営業日の最終約定データまたは`#N/A`

#### 無効な銀柄コード
```excel
=RssTickList(, "9999", 10)
```
結果：`#N/A`

#### 表示本数範囲外
```excel
=RssTickList(, "4755", 500)  // 300超過
```
結果：`#NUM!`

#### 約定データ不足
```excel
=RssTickList(, "4755", 300)  // 実際は50件のみ
```
結果：存在する50件のみ表示、残りは空欄

#### ヘッダー行不正
```excel
=RssTickList($A$1:$D$1, "4755", 10)  // 4列指定だが出力は3列
```
結果：`#REF!` または4列目は空欄表示

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 銘柄コード、表示本数の型と値を確認 |
| #N/A | 銘柄コード無効、データなし | 銘柄コードと市場時間を確認 |
| #NUM! | 表示本数の範囲外 | 1～300の範囲で指定 |
| #REF! | セル参照エラー | ヘッダー行の指定を確認 |

## 関連関数
- **RssMarket**: 国内株式市況情報
- **RssFOPMarket**: 先物OP市況情報
- **RssChart**: チャートデータ
- **RssMarketHeader**: 市況情報ヘッダー行作成

## 注意事項

1. **データの更新**: 歩み値データはリアルタイムで更新されます
2. **表示制限**: 最大300本まで表示可能
3. **市場時間**: 取引時間外では最新の歩み値が表示されます
4. **データ順序**: 最新の約定から古い順に表示されます
5. **ヘッダー行の重要性**: ヘッダー行を指定することで必要な項目のみを効率的に取得

## 歩み値データの活用

### テクニカル分析での利用
- **出来高分析**: 価格帯別の出来高分布
- **約定タイミング**: 重要な価格帯での約定状況
- **流動性確認**: 約定の頻度と規模

### 取引戦略での利用
- **エントリータイミング**: 大口約定後の値動き
- **出来高急増**: 注目度の高まり検知
- **価格サポート**: 特定価格での約定集中

## 出力データの形式

関数実行後、以下の形式でデータが表示されます：

```
Row 1: =RssTickList(, "4755.T", 10) (関数)
Row 2: [ヘッダー行] 時刻    | 出来高  | 約定値
Row 3: [データ1]   14:30:15 | 1000   | 1150
Row 4: [データ2]   14:30:10 | 500    | 1149
Row 5: [データ3]   14:30:05 | 2000   | 1148
...
```

## データ解釈のポイント

| 項目 | 解釈のポイント |
|------|----------------|
| 大口出来高 | 機関投資家の動き |
| 連続約定 | 強い売買圧力 |
| 時刻間隔 | 流動性の高さ |
| 価格推移 | トレンドの方向性 |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「歩み値」