# RssFOPMarket 完全仕様書

## 概要
**関数名**: RssFOPMarket  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 先物OP市況情報の取得  

**説明**: 指定された先物OPの個別銘柄の市況情報をExcelに表示します。国内先物、225先物CME、225先物SGX等の現在値、出来高、建玉等のリアルタイム市場データを取得できます。

## 構文 (Syntax)

```excel
RssFOPMarket("銘柄コード", "取得項目")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 銘柄コード | string | 必須 | **9桁**: 国内先物OP<br>**N225.YYYYMM.C**: 225先物CME<br>**N225.YYYYMM.S**: 225先物SGX<br>※YYYYMMは限月を指定 |
| 2 | 取得項目 | string | 必須 | 先物OP市況情報の取得項目名 |

## 先物OPコード形式

### 国内先物OP
- **形式**: 9桁の数字
- **例**: 165120018

### 海外225先物
- **CME**: N225.202106.C（2021年6月限月CME）
- **SGX**: N225.202106.S（2021年6月限月SGX）

## 主要な取得項目

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 現在値 | 現在の価格 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 出来高 | 当日出来高 | number |
| 建玉 | 建玉数 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |
| 商品名 | 商品名称 | string |

## 使用例

### 国内先物OPの基本使用
```excel
=RssFOPMarket("165120018", "現在値")
```
指定した国内先物OPの現在値を表示します。

### 海外225先物の取得
```excel
=RssFOPMarket("N225.202106.C", "現在値")    // CME 6月限月
=RssFOPMarket("N225.202106.S", "現在値")    // SGX 6月限月
```

### 先物の詳細情報取得
```excel
=RssFOPMarket("165120018", "始値")
=RssFOPMarket("165120018", "高値")
=RssFOPMarket("165120018", "安値")
=RssFOPMarket("165120018", "出来高")
=RssFOPMarket("165120018", "建玉")
```

### セル参照での使用
A1セルに銘柄コード、B1セルに取得項目が入力されている場合：
```excel
=RssFOPMarket(A1, B1)
```

### 商品名の取得
```excel
=RssFOPMarket("165120018", "商品名")
```
先物OP商品の正式名称を取得します。

## 戻り値

### 成功時の出力形式

**データ構造**: 単一セル
- **関数セル**: 指定した取得項目の値

### 実際の出力例

#### 国内先物の現在値
```excel
=RssFOPMarket("165120018", "現在値")
```
結果：`28750` （数値、整数）

#### 商品名の取得
```excel
=RssFOPMarket("165120018", "商品名")
```
結果：`日経225先物2024年06月限` （文字列）

#### CME先物の現在値
```excel
=RssFOPMarket("N225.202406.C", "現在値")
```
結果：`28725` （数値、整数）

#### 建玉数の取得
```excel
=RssFOPMarket("165120018", "建玉")
```
結果：`125000` （数値、枚数）

#### 前日比の取得
```excel
=RssFOPMarket("165120018", "前日比")
```
結果：`+250` （数値、±表記）

### 取得項目別の値範囲・形式

| 取得項目 | データ型 | 値の範囲・形式 | 例 | 備考 |
|----------|----------|----------------|-----|------|
| 現在値 | number | 正数（価格）<br>先物は整数、OPは小数あり | `28750`, `125.50` | 円・ポイント単位 |
| 前日終値 | number | 正数（価格） | `28500`, `120.25` | 前営業日終値 |
| 始値 | number | 正数（価格） | `28600`, `122.00` | 当日始値 |
| 高値 | number | 正数（価格） | `28900`, `128.75` | 当日高値 |
| 安値 | number | 正数（価格） | `28400`, `119.50` | 当日安値 |
| 出来高 | number | 0以上整数 | `25000`, `1500` | 枚数単位 |
| 建玉 | number | 0以上整数 | `125000`, `85000` | 枚数単位 |
| 前日比 | number | 実数（±） | `+250`, `-150` | 前日終値からの差 |
| 前日比率 | number | 実数（%） | `0.88`, `-0.53` | パーセント値（%記号なし） |
| 商品名 | string | 全角文字列 | `日経225先物2024年06月限` | 正式商品名 |

### 商品別の値範囲参考

| 商品タイプ | 価格範囲 | 単位 | 建玉範囲 | 特徴 |
|------------|----------|------|-------------|------|
| 日経225先物 | 20000-35000 | 円 | 50000-300000枚 | 最も流動性が高い |
| TOPIX先物 | 1500-2500 | ポイント | 10000-80000枚 | 機関投資家中心 |
| 日経225OP | 0.01-5000 | 円 | 1000-50000枚 | ボラティリティに依存 |
| CME日経225 | 20000-35000 | 円 | 5000-50000枚 | 海外投資家中心 |
| SGX日経225 | 20000-35000 | 円 | 3000-30000枚 | アジア時間帯中心 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銀柄コード無効、市場休場、限月期限切れ等
- `#REF!` - セル参照エラー

### 特別なケース

#### 市場休場時
```excel
=RssFOPMarket("165120018", "現在値")  // 土日曜日
```
結果：`#N/A` または前営業日終値

#### 限月期限切れ
```excel
=RssFOPMarket("165120018", "現在値")  // 2024年6月限が期限切れ後
```
結果：`#N/A`

#### 無効な銀柄コード
```excel
=RssFOPMarket("999999999", "現在値")
```
結果：`#N/A`

#### 無効な取得項目
```excel
=RssFOPMarket("165120018", "存在しない項目")
```
結果：`#VALUE!`

#### CME/SGXの限月形式エラー
```excel
=RssFOPMarket("N225.202413.C", "現在値")  // 13月は存在しない
```
結果：`#N/A`

#### 取引時間外（CMEメンテナンス時間）
```excel
=RssFOPMarket("N225.202406.C", "現在値")  // CMEメンテナンス中
```
結果：前取引日終了値または`#N/A`

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 銘柄コード、取得項目の形式を確認 |
| #N/A | 銘柄コード無効、市場休場等 | 銘柄コードと市場時間を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssFOPCode**: 先物OPコード検索（銘柄コード検索に使用）
- **RssFOPMarketDes**: 先物OP銘柄情報（制限値幅等）
- **RssMarketHeader**: 市況情報ヘッダー行作成（商品種類=2）
- **RssMarket**: 国内株式市況情報

## 注意事項

1. **限月の管理**: 先物は限月があるため、期限切れに注意
2. **市場時間**: 国内・海外で取引時間が異なります
3. **銘柄コード形式**: 国内（9桁）と海外（英数字）で形式が異なります
4. **建玉データ**: 先物特有の建玉情報が取得可能
5. **CME・SGX**: 海外市場のデータは時差を考慮

## 先物OP市場の特徴

### 取引時間（日本時間）
| 市場 | 取引時間 | 備考 |
|------|----------|------|
| 国内先物 | 8:45-15:15, 16:30-3:00 | 日中・夜間セッション |
| CME | 8:00-7:00 | ほぼ24時間取引 |
| SGX | 8:50-15:25, 16:30-2:00 | アジア時間中心 |

### 限月の読み方
- **202106**: 2021年6月限月
- **202109**: 2021年9月限月
- **202112**: 2021年12月限月

## 先物OPの種類

### 主要商品
| 商品分類 | 商品例 |
|----------|--------|
| 指数先物 | 日経225先物、TOPIX先物 |
| 商品先物 | 金、プラチナ、原油 |
| オプション | 日経225オプション |
| 海外先物 | CME、SGX上場商品 |

## データの活用例

### アービトラージ取引
```excel
// 国内とCMEの価格差監視
=RssFOPMarket("165120018", "現在値") - RssFOPMarket("N225.202106.C", "現在値")
```

### 建玉分析
```excel
=RssFOPMarket("165120018", "建玉")
```
市場参加者の建玉状況を監視できます。

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「先物OP市況情報」