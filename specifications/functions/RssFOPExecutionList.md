# RssFOPExecutionList 完全仕様書

## 概要
**関数名**: RssFOPExecutionList  
**カテゴリ**: 先物OP約定管理 (Futures & Options Execution Management)  
**用途**: 先物OP約定一覧の取得  

**説明**: 先物・オプション取引の約定一覧を取得してExcelに表示します。約定済みの取引の詳細情報（約定価格、約定数量、約定日時等）を確認でき、先物・オプション取引の履歴管理や損益計算に活用できます。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssFOPExecutionList(引数列, ヘッダ行)
```

### VBA関数
```vb
RssFOPExecutionList_V(引数列, ヘッダ行)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 引数列 | ● | number | データ列の開始位置を指定する数値 |
| 2 | ヘッダ行 | ● | number | ヘッダ行の位置を指定する数値 |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な先物OP約定一覧取得
```excel
=RssFOPExecutionList(A1, 1)
```
先物OP約定一覧をA1から表示、1行目にヘッダを配置

### 他の位置での約定一覧表示
```excel
=RssFOPExecutionList(D3, 4)
```
先物OP約定一覧をD3から表示、4行目にヘッダを配置

## 戻り値

### 成功時の出力形式

**データ構造**: マトリクス形式（配列）
- **ヘッダ行**: 項目名
- **データ行**: 各約定の詳細情報

### 実際の出力例

#### 先物OP約定一覧の出力
```excel
=RssFOPExecutionList(A1, 1)
```

| 約定番号 | 注文番号 | 商品種別 | 銘柄コード | 銘柄名 | 売買区分 | 約定数量 | 約定価格 | 約定金額 | 約定日時 | 決済期日 | 手数料 | 建玉区分 |
|----------|----------|----------|-----------|--------|----------|----------|----------|----------|----------|----------|--------|----------|
| FE2024050800001 | F2024050800001 | 先物 | NK225M | 日経225先物 | 買 | 1 | 38450 | 38450000 | 20240508 09:01:15 | 20240613 | 330 | 新規 |
| FE2024050800002 | F2024050800002 | OP | NK225OP240508C38000 | 日経225OP | 売 | 5 | 150 | 75000 | 20240508 10:30:45 | 20240508 | 44 | 新規 |
| FE2024050700003 | F2024050700003 | 先物 | TOPIXM | TOPIX先物 | 売 | 1 | 2750 | 27500000 | 20240507 14:15:32 | 20240613 | 330 | 決済 |

### データ項目の詳細

| 項目 | データ型 | 説明 |
|------|----------|------|
| 約定番号 | string | 約定を一意に識別する番号（例：FE2024050800001） |
| 注文番号 | string | 元となる注文の番号（例：F2024050800001） |
| 商品種別 | string | 先物/OP（オプション） |
| 銘柄コード | string | 先物・オプションの銘柄コード |
| 銘柄名 | string | 銘柄の正式名称 |
| 売買区分 | string | 買/売 |
| 約定数量 | number | 約定した枚数 |
| 約定価格 | number | 1枚あたりの約定価格 |
| 約定金額 | number | 約定価格×約定数量×乗数（手数料・税金除く） |
| 約定日時 | string | 約定した日時（YYYY/MM/DD HH:MM:SS） |
| 決済期日 | string | 先物の決済期日またはオプションの満期日 |
| 手数料 | number | 取引手数料（税込） |
| 建玉区分 | string | 新規/決済 |

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、先物OP口座未開設 | ログイン状況、口座開設状況を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssFOPOrderList**: 先物OP注文一覧
- **RssFOPPositionList**: 先物OP建玉一覧
- **RssFOPCapacityList**: 先物OP余力情報

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年