# RssChart 完全仕様書

## 概要
**関数名**: RssChart  
**カテゴリ**: チャート・テクニカル分析 (Chart & Technical Analysis)  
**用途**: チャート情報（4本値）の取得  

**説明**: 国内株式や先物OP銘柄の指定期間のチャート情報（始値、高値、安値、終値の4本値）をExcelに表示します。日足、週足、月足、分足などの時間軸に対応します。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssChart(引数列, ヘッダ行, 銘柄コード, 足種, 分足表示本数)
```

### VBA関数
```vb
RssChart_V(引数列, ヘッダ行, 銘柄コード, 足種, 分足表示本数)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 引数列 | ● | number | データ列の開始位置を指定する数値 |
| 2 | ヘッダ行 | ● | number | ヘッダ行の位置を指定する数値 |
| 3 | 銘柄コード | ● | string | 4-5桁英数字の銘柄コード<br>「.市場」は省略可（.T:東証, .JAX:JASDAQ, .JNX:JNX） |
| 4 | 足種 | ● | string | チャートの時間軸を指定<br>「D」:日足, 「W」:週足, 「M」:月足, 「1」:1分足, 「3」:3分足, 「5」:5分足, 「10」:10分足, 「15」:15分足, 「30」:30分足, 「60」:60分足 |
| 5 | 分足表示本数 | ● | number | 取得するデータの本数（最大200本） |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な日足チャート取得
```excel
=RssChart(A1, 1, "4755", "D", 50)
```
楽天グループ（4755）の日足チャートを50本取得

### 分足チャートの取得
```excel
=RssChart(C1, 1, "7203", "5", 100)
```
トヨタ自動車（7203）の5分足チャートを100本取得

### 週足チャートの取得
```excel
=RssChart(A5, 2, "9984", "W", 30)
```
ソフトバンクグループ（9984）の週足チャートを30本取得

### 先物のチャート取得
```excel
=RssChart(A1, 1, "NK225M", "D", 60)
```
日経225先物の日足チャートを60本取得

## 戻り値

### 成功時の出力形式

**データ構造**: マトリクス形式（配列）
- **ヘッダ行**: 項目名（日付、始値、高値、安値、終値、出来高）
- **データ行**: 各足の4本値データ

### 実際の出力例

#### 日足チャートの出力
```excel
=RssChart(A1, 1, "4755", "D", 5)
```

| 日付 | 始値 | 高値 | 安値 | 終値 | 出来高 |
|------|------|------|------|------|--------|
| 20240508 | 1100 | 1150 | 1090 | 1140 | 5234000 |
| 20240507 | 1095 | 1120 | 1085 | 1100 | 4567000 |
| 20240506 | 1080 | 1100 | 1070 | 1095 | 3789000 |
| 20240502 | 1075 | 1085 | 1065 | 1080 | 2456000 |
| 20240501 | 1070 | 1080 | 1060 | 1075 | 3123000 |

#### 分足チャートの出力
```excel
=RssChart(A10, 1, "7203", "5", 3)
```

| 日付時刻 | 始値 | 高値 | 安値 | 終値 | 出来高 |
|----------|------|------|------|------|--------|
| 202405081030 | 2500 | 2510 | 2495 | 2505 | 45600 |
| 202405081025 | 2495 | 2505 | 2490 | 2500 | 38200 |
| 202405081020 | 2490 | 2500 | 2485 | 2495 | 41300 |

### データ項目の詳細

| 項目 | データ型 | 説明 |
|------|----------|------|
| 日付/日付時刻 | string | YYYYMMDD形式（日足）またはYYYYMMDDHHMM形式（分足） |
| 始値 | number | その期間の開始価格 |
| 高値 | number | その期間の最高価格 |
| 安値 | number | その期間の最低価格 |
| 終値 | number | その期間の終了価格 |
| 出来高 | number | その期間の売買高 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銘柄コード無効、データなし
- `#NUM!` - 数値パラメータの範囲外
- `#REF!` - セル参照エラー

### 特別なケース

#### 無効な銘柄コード
```excel
=RssChart(A1, 1, "9999", "D", 10)
```
結果：`#N/A`

#### データが存在しない期間
```excel
=RssChart(A1, 1, "4755", "D", 1000)  // 過大な本数指定
```
結果：利用可能な最大本数までのデータを返却

#### 市場休場中の分足要求
```excel
=RssChart(A1, 1, "4755", "1", 10)  // 休場中
```
結果：最新の取引時間のデータまでを返却

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー、足種指定不正 | パラメータの型と値、足種指定を確認 |
| #N/A | 銘柄コード無効、データなし | 銘柄コード、データ期間を確認 |
| #NUM! | 表示本数の範囲外 | 表示本数を1-200の範囲で指定 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssChartPast**: 過去チャート情報（開始日指定）
- **RssTrendSMA**: 移動平均線データ
- **RssMarket**: リアルタイム市況データ
- **RssTickList**: ティック（歩み値）データ

## 注意事項

1. **データ制限**: 最大200本まで取得可能です
2. **時間軸制限**: 分足データは当日および前営業日のみ利用可能
3. **市場時間**: 分足データは市場開場時間のみ更新されます
4. **データ更新**: 日足以上は翌営業日に確定データが反映されます
5. **銘柄制限**: 先物・オプションは専用コードを使用してください

## 足種の詳細

### 日足系
| 足種 | 説明 | データ期間 |
|------|------|-----------|
| D | 日足 | 約3年分 |
| W | 週足 | 約5年分 |
| M | 月足 | 約10年分 |

### 分足系
| 足種 | 説明 | データ期間 |
|------|------|-----------|
| 1 | 1分足 | 当日+前営業日 |
| 3 | 3分足 | 当日+前営業日 |
| 5 | 5分足 | 当日+前営業日 |
| 10 | 10分足 | 当日+前営業日 |
| 15 | 15分足 | 当日+前営業日 |
| 30 | 30分足 | 当日+前営業日 |
| 60 | 60分足 | 当日+前営業日 |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF