# RssFutInfo 完全仕様書

## 概要
**関数名**: RssFutInfo  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 先物取引情報の取得  

**説明**: 先物OPの証拠金情報を一覧表示します。SPAN証拠金額、SPAN証拠金額概算、当社SPAN証拠金額など、先物取引に必要な証拠金関連情報を取得できます。

## 構文 (Syntax)

```excel
RssFutInfo(ヘッダー行)
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | ヘッダー行 | セル参照 | 任意 | 取得項目をセル範囲で指定。範囲指定は1行のみ（A1:C1形式）<br>省略時は全ての出力項目を表示。取得項目は出力項目から選択可能 |

## 主要な出力項目

| No | 項目名 | 説明 | データ型 |
|----|--------|------|----------|
| 1 | 商品種類 | 先物OP商品の種類名称 | string |
| 2 | SPAN証拠金額 | 標準的なSPAN証拠金額 | number |
| 3 | SPAN証拠金額概算 | SPAN証拠金の概算額 | number |
| 4 | 当社SPAN証拠金額 | 楽天証券独自のSPAN証拠金額 | number |

## SPAN証拠金とは

**SPAN (Standard Portfolio Analysis of Risk)**は、先物・オプション取引における リスクベース証拠金制度です。

### 特徴
- **ポートフォリオベース**: 個別ポジションではなく、ポートフォリオ全体のリスクを評価
- **リスクベース**: 市場リスクに基づいて証拠金を算出
- **動的計算**: 市況変動に応じて証拠金額が変動

## 使用例

### 基本的な使用方法
```excel
=RssFutInfo()
```
A1セルに入力すると、先物取引情報の全取得項目を表示します。

### ヘッダー行を指定した取得
```excel
=RssFutInfo($A$2:$D$2)
```
2行目をヘッダーとして使用し、必要な項目のみを表示します。

### 特定項目のみの取得
A2セルに「商品種類」、B2セルに「SPAN証拠金額」のヘッダーがある場合：
```excel
=RssFutInfo($A$2:$B$2)
```

## 出力データの例

一般的な出力データ例：

| 商品種類 | SPAN証拠金額 | SPAN証拠金額概算 | 当社SPAN証拠金額 |
|----------|--------------|------------------|------------------|
| 日経225先物 | 450000 | 480000 | 450000 |
| 日経225ミニ | 45000 | 48000 | 45000 |
| 金先物 | 180000 | 190000 | 180000 |
| 原油先物 | 250000 | 260000 | 250000 |

## 戻り値

### 成功時の出力形式

**データ構造**: 多行多列連続セル出力
- **関数セル**: 全項目が表示された場合のヘッダー行
- **第2行以降**: 先物商品ごとのSPAN証拠金情報

### 実際の出力例

#### 全項目取得の例
```excel
=RssFutInfo()
```

**出力結果**:
| 行 | 商品種類 | SPAN証拠金額 | SPAN証拠金額概算 | 当社SPAN証拠金額 |
|-----|-----------|------------------|----------------------|------------------------|
| 1(関数) | 商品種類 | SPAN証拠金額 | SPAN証拠金額概算 | 当社SPAN証拠金額 |
| 2 | 日経225先物 | 450000 | 480000 | 450000 |
| 3 | 日経225ミニ | 45000 | 48000 | 45000 |
| 4 | TOPIX先物 | 380000 | 400000 | 380000 |
| 5 | 金先物 | 180000 | 190000 | 180000 |
| 6 | プラチナ先物 | 120000 | 125000 | 120000 |
| 7 | 原油先物 | 250000 | 260000 | 250000 |

#### 特定項目のみ取得
```excel
=RssFutInfo($A$1:$B$1)  // 商品種類とSPAN証拠金額のみ
```

**出力結果**:
| 行 | 商品種類 | SPAN証拠金額 |
|-----|-----------|------------------|
| 1(関数) | 商品種類 | SPAN証拠金額 |
| 2 | 日経225先物 | 450000 |
| 3 | 日経225ミニ | 45000 |
| 4 | TOPIX先物 | 380000 |

### 出力項目別の値範囲・形式

| 項目名 | データ型 | 値の範囲・形式 | 例 | 備考 |
|--------|----------|----------------|-----|------|
| 商品種類 | string | 全角文字列 | `日経225先物`, `金先物` | 正式商品名 |
| SPAN証拠金額 | number | 10000-2000000程度 | `450000`, `45000`, `180000` | 円単位、整数 |
| SPAN証拠金額概算 | number | 10000-2100000程度 | `480000`, `48000`, `190000` | 円単位、整数 |
| 当社SPAN証拠金額 | number | 10000-2000000程度 | `450000`, `45000`, `180000` | 円単位、整数 |

### 商品別証拠金範囲

| 商品タイプ | SPAN証拠金範囲 | 取引単位 | レバレッジ 目安 | 特徴 |
|------------|------------------|----------|-----------------|------|
| 日経225先物 | 300000-600000円 | 1000倍 | 60-100倍 | 最も流動性が高い |
| 日経225ミニ | 30000-60000円 | 100倍 | 60-100倍 | 少額から参加可能 |
| TOPIX先物 | 250000-500000円 | 10000倍 | 40-80倍 | 機関投資家中心 |
| 金先物 | 100000-300000円 | 1kg | 20-50倍 | 安全資産として人気 |
| プラチナ先物 | 80000-200000円 | 500g | 15-40倍 | 貴金属分散投資 |
| 原油先物 | 150000-400000円 | 50kL | 10-30倍 | エネルギー関連 |
| ゴム先物 | 100000-250000円 | 5トン | 15-35倍 | 商品先物代表 |

### SPAN証拠金の特徴

| 項目 | 意味 | 範囲 |
|------|------|------|
| SPAN証拠金額 | 標準的なリスクベース証拠金 | 市場リスクに基づく |
| 概算額 | 予想される証拠金額 | 通常は標準額より高め |
| 当社額 | 楽天証券独自の証拠金基準 | 最終適用額 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - データ取得エラー、RSS未接続
- `#REF!` - セル参照エラー

### 特別なケース

#### RSS未接続時
```excel
=RssFutInfo()
```
結果：`#N/A`

#### ヘッダー行指定エラー
```excel
=RssFutInfo($A$1:$F$1)  // 6列指定だが出力は4列
```
結果：最初4列のみ表示、残りは空欄

#### 市場休場時
```excel
=RssFutInfo()  // 土日曜日に実行
```
結果：前営業日の証拠金情報または`#N/A`

#### 証拠金変更適用日
```excel
=RssFutInfo()  // 証拠金規則変更日
```
**出力結果**: 新しい証拠金額が適用
| 商品種類 | SPAN証拠金額(旧) | SPAN証拠金額(新) |
|-----------|----------------------|----------------------|
| 日経225先物 | 450000 | 520000 |

#### 新商品上場時
```excel
=RssFutInfo()  // 新しい先物商品が上場
```
結果：新商品の証拠金情報が追加される

#### ボラティリティ急上昇時
```excel
=RssFutInfo()  // 市場ボラティリティが高い時期
```
**出力結果**: 証拠金額が全般的に上昇
| 商品種類 | 平常時 | 高ボラ時 |
|-----------|----------|----------|
| 日経225先物 | 450000 | 650000 |

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | ヘッダー行の指定形式を確認 |
| #N/A | データ取得エラー | RSS接続状況を確認 |
| #REF! | セル参照エラー | ヘッダー行の指定を確認 |

## 関連関数
- **RssFOPMarket**: 先物OP市況情報
- **RssFOPCode**: 先物OPコード検索
- **RssFOPPositionList**: 先物OP建玉一覧
- **RssFOPOrder**: 先物OP注文

## 注意事項

1. **データの更新**: 最新の証拠金情報を表示するには、マーケットスピード IIタブ側の「更新アイコン」をクリックしてください
2. **証拠金の変動**: SPAN証拠金は市況により日々変動します
3. **当社独自基準**: 楽天証券では独自の証拠金基準を適用する場合があります
4. **リスク管理**: 証拠金額は最低必要額であり、十分な余力を持つことが重要
5. **取引時間**: 証拠金情報は取引時間内に更新されます

## 実用的な活用例

### 必要証拠金の事前確認
```excel
=RssFutInfo()
```
取引前に各商品の必要証拠金を確認

### ポートフォリオリスク管理
```excel
// 複数商品の証拠金を合計してポートフォリオリスクを計算
=SUMIF(A:A,"*先物*",C:C) // 先物商品の証拠金合計
```

### 証拠金効率の比較
```excel
// 証拠金あたりの取引単位を比較
=取引単位金額 / SPAN証拠金額 // レバレッジ効率
```

## SPAN証拠金の算出要素

### 価格スキャンレンジ
- **アップムーブ**: 価格上昇時のリスク
- **ダウンムーブ**: 価格下落時のリスク

### ボラティリティスキャンレンジ  
- **ボラティリティ変動**: IV変動リスク
- **時間減価**: 時間経過によるリスク

### 最小証拠金
- **商品別最小額**: 各商品の最低証拠金額
- **当社基準**: 楽天証券独自の最小証拠金

## 証拠金管理の重要性

### リスク管理
1. **余力確保**: 証拠金の150%程度の余力推奨
2. **追証回避**: 証拠金不足による強制決済の回避
3. **分散投資**: 単一商品への集中リスク回避

### 資金効率
1. **SPAN効果**: 異なるポジションのリスク相殺効果
2. **クロスマージン**: 複数口座間での証拠金効率化
3. **最適配分**: リスクとリターンの最適バランス

## 出力データの形式

関数実行後、以下の形式でデータが表示されます：

```
Row 1: =RssFutInfo() (関数)
Row 2: [ヘッダー行] 商品種類    | SPAN証拠金額 | SPAN証拠金額概算 | 当社SPAN証拠金額
Row 3: [データ1]   日経225先物 | 450000      | 480000          | 450000
Row 4: [データ2]   日経225ミニ | 45000       | 48000           | 45000
Row 5: [データ3]   金先物      | 180000      | 190000          | 180000
...
```

## 証拠金情報の活用戦略

### ポジション構築
1. **証拠金効率**: 限られた資金での最適ポジション
2. **リスク分散**: 異なる商品への分散投資
3. **SPAN効果**: 相関の低い商品の組み合わせ

### リスク監視
1. **日次監視**: 証拠金変動の継続監視
2. **アラート設定**: 証拠金増加時の通知設定
3. **余力管理**: 維持証拠金との比較

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「先物取引情報」
- SPAN証拠金制度について