# RssMarginInfo 完全仕様書

## 概要
**関数名**: RssMarginInfo  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 信用取引情報の取得  

**説明**: 指定した国内株式の信用取引情報を表示します。売建可能数量、貸株料率、制度・一般信用の各区分での建玉可否等の信用取引に必要な情報を取得できます。

## 構文 (Syntax)

```excel
RssMarginInfo(ヘッダー行, "銘柄コード")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | ヘッダー行 | セル参照 | 任意 | 取得項目をセル範囲で指定。範囲指定は1行のみ（A1:C1形式）<br>省略時は全ての出力項目を表示。取得項目は出力項目から選択可能 |
| 2 | 銘柄コード | string | 必須 | **英数字4桁(5桁)**: 東証<br>**英数字4桁(5桁).T**: 東証<br>**英数字4桁(5桁).JAX**: JASDAQ<br>**英数字4桁(5桁).JNX**: JNX |

## 主要な出力項目

| No | 項目名 | 説明 | データ型 |
|----|--------|------|----------|
| 1 | 売建可能数量 | 信用売建が可能な株数 | number |
| 2 | 特別空売り料 | 特別空売り時の追加料率 | number |
| 3 | 特別空売り料適用日 | 特別空売り料が適用される日付 | date |
| 4 | 制度_買建 | 制度信用での買建可否 | string |
| 5 | 制度_売建 | 制度信用での売建可否 | string |
| 6 | 一般_1日_買建 | 一般信用1日での買建可否 | string |
| 7 | 一般_1日_売建 | 一般信用1日での売建可否 | string |
| 8 | 一般_短期_買建 | 一般信用短期での買建可否 | string |
| 9 | 一般_短期_売建 | 一般信用短期での売建可否 | string |
| 10 | 一般_無期限_買建 | 一般信用無期限での買建可否 | string |
| 11 | 一般_無期限_売建 | 一般信用無期限での売建可否 | string |
| 12 | 信用貸株料率 | 信用取引の貸株料率 | number |
| 13 | 信用貸株料率適用日 | 貸株料率の適用開始日 | date |

## 信用区分の説明

### 制度信用
- **返済期限**: 6ヶ月以内
- **貸株料**: 年率約2.8%
- **逆日歩**: 発生する場合あり

### 一般信用
| 区分 | 返済期限 | 特徴 |
|------|----------|------|
| 1日 | 当日中 | デイトレード専用 |
| 短期 | 14日以内 | 短期取引向け |
| 無期限 | 無期限 | 長期保有可能 |

## 使用例

### 基本的な使用方法
```excel
=RssMarginInfo(, "4755.T")
```
A1セルに入力すると、楽天株について信用取引情報の全取得項目を表示します。

### ヘッダー行を指定した取得
```excel
=RssMarginInfo($A$2:$M$2, "7203")
```
2行目をヘッダーとして使用し、トヨタ株の信用取引情報を表示します。

### 特定項目のみの取得
A2セルに「売建可能数量」、B2セルに「貸株料率」のヘッダーがある場合：
```excel
=RssMarginInfo($A$2:$B$2, "4755")
```

## 戻り値

### 成功時の出力形式

**データ構造**: 多列連続セル出力
- **関数セル**: 全項目が表示された場合のヘッダー行
- **第2行**: 信用取引情報データ

### 実際の出力例

#### 全項目取得の例
```excel
=RssMarginInfo(, "4755")
```

**出力結果**:
| 行 | 売建可能数量 | 特別空売り料 | 制度_買建 | 制度_売建 | 一般_1日_買建 | 一般_1日_売建 | 信用貸株料率 |
|-----|-----------------|----------------|-----------|-----------|----------------|----------------|----------------|
| 1(関数) | 売建可能数量 | 特別空売り料 | 制度_買建 | 制度_売建 | 一般_1日_買建 | 一般_1日_売建 | 信用貸株料率 |
| 2 | 50000 | 0.00 | ○ | ○ | ○ | ○ | 2.80 |

#### 特定項目のみ取得
```excel
=RssMarginInfo($A$1:$C$1, "7203")  // 売建可能数量、制度_売建、貸株料率のみ
```

**出力結果**:
| 行 | 売建可能数量 | 制度_売建 | 信用貸株料率 |
|-----|-----------------|-----------|----------------|
| 1(関数) | 売建可能数量 | 制度_売建 | 信用貸株料率 |
| 2 | 25000 | ○ | 2.85 |

### 出力項目別の値範囲・形式

| 項目名 | データ型 | 値の範囲・形式 | 例 | 備考 |
|--------|----------|----------------|-----|------|
| 売建可能数量 | number | 0以上整数 | `0`, `50000`, `100000` | 株数単位、0は売建不可 |
| 特別空売り料 | number | 0.00-50.00程度 | `0.00`, `1.10`, `5.25` | 年率%、1未満は稀 |
| 特別空売り料適用日 | date | YYYYMMDD形式 | `20240401`, `20240508` | 適用開始日 |
| 制度_買建 | string | ○/×/△ | `○`, `×`, `△` | 可否表示 |
| 制度_売建 | string | ○/×/△ | `○`, `×`, `△` | 可否表示 |
| 一般_1日_買建 | string | ○/×/△ | `○`, `×`, `△` | デイトレ専用 |
| 一般_1日_売建 | string | ○/×/△ | `○`, `×`, `△` | デイトレ専用 |
| 一般_短期_買建 | string | ○/×/△ | `○`, `×`, `△` | 14日以内 |
| 一般_短期_売建 | string | ○/×/△ | `○`, `×`, `△` | 14日以内 |
| 一般_無期限_買建 | string | ○/×/△ | `○`, `×`, `△` | 無期限保有可 |
| 一般_無期限_売建 | string | ○/×/△ | `○`, `×`, `△` | 無期限保有可 |
| 信用貸株料率 | number | 0.50-10.00程度 | `2.80`, `3.25`, `4.50` | 年率%、小数点以下2桁 |
| 信用貸株料率適用日 | date | YYYYMMDD形式 | `20240401`, `20240515` | 料率変更適用日 |

### 信用可否表示の意味

| 表示 | 意味 | 説明 |
|------|------|------|
| ○ | 取引可能 | 通常の信用取引が可能 |
| × | 取引不可 | 信用取引対象外 |
| △ | 条件付き | 一定の条件下で可能 |
| - | データなし | 情報が取得できない |

### 銀柄別特徴

| 銀柄タイプ | 売建可能数量 | 貸株料率範囲 | 特徴 |
|------------|-----------------|----------------|------|
| 主要銀柄 | 10000-500000株 | 2.50-3.50% | 安定した信用取引 |
| 新興銀柄 | 0-50000株 | 3.00-8.00% | 売建制限あり |
| 人気銀柄 | 0-100000株 | 3.50-10.00% | 日中変動あり |
| 低位銀柄 | 1000-20000株 | 5.00-15.00% | 高い貸株料率 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銀柄コード無効、データなし
- `#REF!` - セル参照エラー

### 特別なケース

#### 信用取引対象外銀柄
```excel
=RssMarginInfo(, "4755")  // 信用対象外の場合
```
**出力結果**:
| 売建可能数量 | 制度_買建 | 制度_売建 | 信用貸株料率 |
|-----------------|-----------|-----------|----------------|
| 0 | × | × | - |

#### 無効な銀柄コード
```excel
=RssMarginInfo(, "9999")
```
結果：`#N/A`

#### ヘッダー行エラー
```excel
=RssMarginInfo($A$1:$E$1, "4755")  // 5列指定だが出力は13列
```
結果：最初5列のみ表示、残りは空欄

#### 特別空売り料発生時
```excel
=RssMarginInfo(, "1234")  // 空売り規制銀柄
```
**出力結果**:
| 売建可能数量 | 特別空売り料 | 特別空売り料適用日 | 制度_売建 |
|-----------------|----------------|----------------------|-----------|
| 10000 | 1.10 | 20240508 | △ |

#### 一部信用区分のみ対応
```excel
=RssMarginInfo(, "5678")  // 一般信用のみ対応
```
**出力結果**:
| 制度_買建 | 制度_売建 | 一般_1日_買建 | 一般_短期_買建 |
|-----------|-----------|----------------|------------------|
| × | × | ○ | ○ |

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 銘柄コードの形式を確認 |
| #N/A | 銘柄コード無効、データなし | 銘柄コードを確認 |
| #REF! | セル参照エラー | ヘッダー行の指定を確認 |

## 関連関数
- **RssMarginPositionList**: 信用建玉一覧（現在の建玉状況確認）
- **RssMarginCloseOrder**: 信用返済注文（返済注文発注）
- **RssMarginOpenOrder**: 信用新規注文（新規建玉）
- **RssMarket**: 国内株式市況情報

## 注意事項

1. **データの更新**: 最新の信用取引情報を表示するには、マーケットスピード IIタブ側の「更新アイコン」をクリックしてください
2. **売建可能数量**: リアルタイムで変動します
3. **貸株料率**: 銘柄や市況により変動する場合があります
4. **空売り規制**: 特別空売り料が適用される場合があります
5. **信用区分の違い**: 各区分で取引条件が異なります

## 実用的な活用例

### 信用売建の事前確認
```excel
=RssMarginInfo(, "4755")
```
売建前に売建可能数量と各信用区分での可否を確認

### 貸株料率の監視
```excel
// A列: 銘柄コード
// B列: =RssMarginInfo($D$1:$D$1, A2) // 貸株料率のみ取得
4755
7203
9984
```

### コスト計算
```excel
// 貸株料率を取得して年間コストを計算
=RssMarginInfo(, "4755") // 貸株料率取得
=建玉金額 * 貸株料率 / 100 // 年間コスト計算
```

## データ解釈のポイント

### 売建可能数量
- **0**: 売建不可
- **数値**: 売建可能な最大株数
- **変動**: リアルタイムで変動

### 信用区分可否の表示
一般的な表示例：
- **○**: 取引可能
- **×**: 取引不可
- **△**: 条件付き取引可能

### 特別空売り料
- **通常**: 0%
- **規制時**: 追加料率が適用
- **適用日**: 料率変更の適用日

## 出力データの形式

関数実行後、以下の形式でデータが表示されます：

```
Row 1: =RssMarginInfo(, "4755") (関数)
Row 2: [ヘッダー行] 売建可能数量 | 制度_買建 | 制度_売建 | 貸株料率 | ...
Row 3: [データ]     10000      | ○       | ○       | 2.80    | ...
```

## 信用取引戦略での活用

### 売建戦略
1. **売建可能数量の確認**
2. **貸株料率のコスト計算**  
3. **適切な信用区分の選択**

### リスク管理
1. **特別空売り料の監視**
2. **返済期限の管理**
3. **逆日歩リスクの考慮**

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「信用取引情報」
- 楽天証券信用取引ルール