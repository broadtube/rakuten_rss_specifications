# RssFOPOpenOrder 非公式テスト確認仕様

## 概要
**関数名**: RssFOPOpenOrder  
**カテゴリ**: 先物OP注文管理 (Futures & Options Order Management)  
**用途**: 先物OP新規注文の発注  

**説明**: 指定した銘柄について、注文区分ごとに先物オプションの新規注文を出します。日経225先物、TOPIX先物、各種オプション商品に対応し、逆指値注文も可能です。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssFOPOpenOrder(発注ID, 発注トリガー, 銘柄コード, 売買区分, 注文区分, 注文数量, 価格区分, 注文価格, 執行数量条件, 執行時間条件, 注文期限, 逆指値条件価格, 逆指値条件区分, 逆指値価格区分, 逆指値価格, SOR区分)
```

### VBA関数
```vb
RssFOPOpenOrder_V(発注ID, 銘柄コード, 売買区分, 注文区分, 注文数量, 価格区分, 注文価格, 執行数量条件, 執行時間条件, 注文期限, 逆指値条件価格, 逆指値条件区分, 逆指値価格区分, 逆指値価格, SOR区分)
```
※VBA関数は第2引数の「発注トリガー」を除いた入力形式となります

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 発注ID | ● | 数値 | Excelから注文を一意に識別するための番号（1以上の数値で入力。） |
| 2 | 発注トリガー | ● | 数値 | 0（False）:待機、1（True）:発注 （省略時は、「0（False）:待機」）<br>（直接True/Falseを入力可。また、数式入力も可。） |
| 3 | 銘柄コード | ● | 文字列 | 銘柄コード 9桁 |
| 4 | 売買区分 | ● | 文字列 | 1:売り（売建）、3:買い（買建） |
| 5 | 注文区分 | ● | 文字列 | 0:通常注文、1:逆指値付通常注文、2:逆指値注文 |
| 6 | 注文数量 | ● | 数値 | 注文数量を入力。 |
| 7 | 価格区分 | △ | 文字列 | 0:成行、1:指値<br>（注文区分が「0:通常注文」 or 「1:逆指値付通常注文」 の場合、必須。） |
| 8 | 注文価格 | △ | 数値 | 注文価格を入力。成行の場合は省略。<br>（注文区分が「0:通常注文」 or 「1:逆指値付通常注文」 の場合、必須。） |
| 9 | 執行数量条件 | ● | 文字列 | 1:FOK、2:FAK、3:FAS |
| 10 | 執行時間条件 | ● | 文字列 | 1:本日中、2:今週中、3:寄付、4:引け、5:期間指定、6:大引不成、7:不成 |
| 11 | 注文期限 | △ | 文字列 | 執行時間条件が「5:期間指定」の場合、必須。(YYYYMMDD) |
| 12 | 逆指値条件価格 | △ | 数値 | 逆指値条件価格を入力。<br>（注文区分が「1:逆指値付通常注文」 or 「2:逆指値注文」の場合、必須。） |
| 13 | 逆指値条件区分 | △ | 文字列 | 1:以上、2:以下<br>（注文区分が「1:逆指値付通常注文」 or 「2:逆指値注文」の場合、必須。） |
| 14 | 逆指値価格区分 | △ | 文字列 | 0:成行、1:指値<br>（注文区分が「1:逆指値付通常注文」 or 「2:逆指値注文」の場合、必須。） |
| 15 | 逆指値価格 | △ | 数値 | 逆指値価格を入力。成行の場合は省略。<br>（注文区分が「1:逆指値付通常注文」 or 「2:逆指値注文」の場合、必須。） |
| 16 | SOR区分 | △ | 文字列 | 0:通常注文、1:SOR注文（省略時は、「0:通常注文」） |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 日経225先物の通常買い注文
```excel
=RssFOPOpenOrder(1, 1, "167120019", "3", "0", 1, "1", 38500, "3", "1", , , , , , "0")
```

### オプションの売建注文
```excel
=RssFOPOpenOrder(2, 1, "188120318", "1", "0", 10, "1", 150, "3", "1", , , , , , "0")
```

### 逆指値注文の例
```excel
=RssFOPOpenOrder(3, 1, "167120019", "3", "2", 1, , , "3", "1", , 38000, "1", "1", 38500, "0")
```

## 戻り値

### 成功時の出力
**データ型**: 文字列  
**内容**: 発注結果を表示（「上記に同じ」等）

### 失敗時の出力
**可能なエラー**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - ログインエラー、先物OP口座未開設
- `銘柄コードが不正です。` - 銘柄コードエラー
- `発注IDが重複しています。` - 発注ID重複エラー

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、先物OP口座未開設 | ログイン状況、口座開設状況を確認 |
| 銘柄コードが不正 | 銘柄コードが無効 | 正しい銘柄コードを指定 |
| 発注ID重複 | 同じ発注IDが既に使用されている | 別の発注IDを指定 |

## 活用例

### 複数注文の管理
```excel
// 発注IDを連番で管理
A1: 1
A2: =A1+1
// 各行で異なる銘柄を注文
B1: =RssFOPOpenOrder(A1, 1, "167120019", "3", "0", 1, "1", 38500, "3", "1", , , , , , "0")
B2: =RssFOPOpenOrder(A2, 1, "167120019", "1", "0", 1, "1", 38600, "3", "1", , , , , , "0")
```

### VBAでの活用
```vb
Sub PlaceFOPOrder()
    Dim result As String
    ' VBA関数では発注トリガーを除く
    result = Application.WorksheetFunction.RssFOPOpenOrder_V( _
        1, "167120019", "3", "0", 1, "1", 38500, "3", "1", "", "", "", "", "", "0")
    
    If result <> "#VALUE!" And result <> "#N/A" Then
        MsgBox "注文が送信されました: " & result
    Else
        MsgBox "注文エラー: " & result
    End If
End Sub
```

## 関連関数
- **RssFOPCloseOrder**: 先物OP決済注文
- **RssFOPModifyOrder**: 先物OP注文訂正
- **RssFOPCancelOrder**: 先物OP注文取消
- **RssFOPOrderList**: 先物OP注文一覧
- **RssFOPExecutionList**: 先物OP約定一覧

## 注意事項

1. **自動更新対応**: この関数は自動更新対象です（○）
2. **ログイン必要**: 楽天証券へのログインが必要です
3. **先物OP口座必要**: 先物・オプション取引口座の開設が必要です
4. **発注IDの一意性**: 発注IDは一意である必要があります
5. **VBA関数の違い**: VBA関数は第2引数の「発注トリガー」を除いた形式です
6. **注文区分とパラメータ**: 注文区分によって必須パラメータが異なります
7. **執行条件の詳細**: 執行数量条件と執行時間条件は別々に指定が必要です

## パラメータの説明

### 執行数量条件
- 1:FOK (Fill or Kill) - 全量即時約定または取消
- 2:FAK (Fill and Kill) - 一部約定後、残数量取消
- 3:FAS (Fill and Store) - 一部約定後、残数量は注文として残る

### 執行時間条件
- 1:本日中 - 当日のセッション終了まで有効
- 2:今週中 - 週末まで有効
- 3:寄付 - 寄付のみ執行
- 4:引け - 引けのみ執行
- 5:期間指定 - 指定日まで有効
- 6:大引不成 - 引けで成行に変更
- 7:不成 - 引けまでに約定しなければ成行に変更

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF