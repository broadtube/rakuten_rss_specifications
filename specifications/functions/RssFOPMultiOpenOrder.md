# RssFOPMultiOpenOrder 非公式テスト確認仕様

## 概要
**関数名**: RssFOPMultiOpenOrder  
**カテゴリ**: 先物OP注文管理 (Futures & Options Order Management)  
**用途**: 先物OP複数新規注文の発注  

**説明**: 指定した2件の銘柄について、注文区分ごとに先物オプションの新規注文を出します。複数銘柄の同時発注により効率的なポジション構築が可能です。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssFOPMultiOpenOrder(発注ID, 発注トリガー, 銘柄コード1, 売買区分1, 注文区分1, 注文数量1, 価格区分1, 注文価格1, 執行数量条件1, 執行時間条件1, 注文期限1, 銘柄コード2, 売買区分2, 注文区分2, 注文数量2, 価格区分2, 注文価格2, 執行数量条件2, 執行時間条件2, 注文期限2)
```

### VBA関数
```vb
RssFOPMultiOpenOrder_V(発注ID, 銘柄コード1, 売買区分1, 注文区分1, 注文数量1, 価格区分1, 注文価格1, 執行数量条件1, 執行時間条件1, 注文期限1, 銘柄コード2, 売買区分2, 注文区分2, 注文数量2, 価格区分2, 注文価格2, 執行数量条件2, 執行時間条件2, 注文期限2)
```
※VBA関数は第2引数の「発注トリガー」を除いた入力形式となります

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 発注ID | ● | 数値 | Excelから注文を一意に識別するための番号（1以上の数値で入力。） |
| 2 | 発注トリガー | ● | 数値 | 0（False）:待機、1（True）:発注 （省略時は、「0（False）:待機」）<br>（直接True/Falseを入力可。また、数式入力も可。） |
| 3 | 銘柄コード1 | ● | 文字列 | 銘柄コード 9桁 |
| 4 | 売買区分1 | ● | 文字列 | 1:売り（売建）、3:買い（買建） |
| 5 | 注文区分1 | ● | 文字列 | 0:通常注文 |
| 6 | 注文数量1 | ● | 数値 | 注文数量を入力。 |
| 7 | 価格区分1 | △ | 文字列 | 0:成行、1:指値 |
| 8 | 注文価格1 | △ | 数値 | 注文価格を入力。成行の場合は省略。 |
| 9 | 執行数量条件1 | ● | 文字列 | 1:FOK、2:FAK、3:FAS |
| 10 | 執行時間条件1 | ● | 文字列 | 1:当セッション、4:引け、5:期間指定、9:取引最終日 |
| 11 | 注文期限1 | △ | 文字列 | 執行時間条件が「5:期間指定」の場合、必須。(YYYYMMDD) |
| 12 | 銘柄コード2 | △ | 文字列 | 銘柄コード 9桁（2件目、省略可） |
| 13 | 売買区分2 | △ | 文字列 | 1:売り（売建）、3:買い（買建）（銘柄コード2入力時は必須） |
| 14 | 注文区分2 | △ | 文字列 | 0:通常注文（銘柄コード2入力時は必須） |
| 15 | 注文数量2 | △ | 数値 | 注文数量を入力。（銘柄コード2入力時は必須） |
| 16 | 価格区分2 | △ | 文字列 | 0:成行、1:指値 |
| 17 | 注文価格2 | △ | 数値 | 注文価格を入力。成行の場合は省略。 |
| 18 | 執行数量条件2 | △ | 文字列 | 1:FOK、2:FAK、3:FAS（銘柄コード2入力時は必須） |
| 19 | 執行時間条件2 | △ | 文字列 | 1:当セッション、4:引け、5:期間指定、9:取引最終日（銘柄コード2入力時は必須） |
| 20 | 注文期限2 | △ | 文字列 | 執行時間条件が「5:期間指定」の場合、必須。(YYYYMMDD) |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

**重要**: 
- 2件目は省略可。銘柄コード2入力時、1件目の必須項目に該当する項目は必須。
- この関数では逆指値注文とSOR注文は利用できません（注文区分は「0:通常注文」のみ）

## 使用例

### 2銘柄の同時新規注文
```excel
=RssFOPMultiOpenOrder(1, 1, "167120019", "3", "0", 1, "1", 38500, "3", "1", , "188120318", "1", "0", 10, "1", 150, "3", "1", )
```
日経225先物と日経225オプションを同時に新規注文

### 1銘柄のみの新規注文（2件目省略）
```excel
=RssFOPMultiOpenOrder(2, 1, "167120019", "3", "0", 2, "0", , "3", "1", , , , , , , , , , )
```
日経225先物のみ成行で新規注文

### 期間指定での複数注文
```excel
=RssFOPMultiOpenOrder(3, 1, "167120019", "3", "0", 1, "1", 38500, "3", "5", "20241210", "167130019", "3", "0", 1, "1", 39000, "3", "5", "20241210")
```
異なる限月の先物を期間指定で同時注文

## 戻り値

### 成功時の出力
**データ型**: 文字列  
**内容**: 発注結果を表示（「上記に同じ」等）

### 失敗時の出力
**可能なエラー**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - ログインエラー、先物OP口座未開設
- `銘柄コードが不正です。` - 銘柄コードエラー
- `発注IDが重複しています。` - 発注ID重複エラー

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー、先物OP口座未開設 | ログイン状況、口座開設状況を確認 |
| 銘柄コードが不正 | 銘柄コードが無効 | 正しい銘柄コードを指定 |
| 発注ID重複 | 同じ発注IDが既に使用されている | 別の発注IDを指定 |

## 活用例

### スプレッド取引の構築
```excel
// 買いと売りの両建て
=RssFOPMultiOpenOrder(1, 1, "167120019", "3", "0", 1, "1", 38500, "3", "1", , "167120019", "1", "0", 1, "1", 38600, "3", "1", )
```

### オプションストラテジーの構築
```excel
// コールとプットの同時購入（ストラドル）
=RssFOPMultiOpenOrder(2, 1, "188120318", "3", "0", 5, "1", 150, "3", "1", , "189120318", "3", "0", 5, "1", 140, "3", "1", )
```

### VBAでの活用
```vb
Sub PlaceMultipleFOPOrders()
    Dim result As String
    ' VBA関数では発注トリガーを除く
    result = Application.WorksheetFunction.RssFOPMultiOpenOrder_V( _
        1, "167120019", "3", "0", 1, "1", 38500, "3", "1", "", _
        "188120318", "1", "0", 10, "1", 150, "3", "1", "")
    
    If result <> "#VALUE!" And result <> "#N/A" Then
        MsgBox "複数注文が送信されました: " & result
    Else
        MsgBox "注文エラー: " & result
    End If
End Sub
```

## 関連関数
- **RssFOPOpenOrder**: 先物OP個別新規注文
- **RssFOPMultiCloseOrder**: 先物OP複数決済注文
- **RssFOPCloseOrder**: 先物OP個別決済注文
- **RssFOPOrderList**: 先物OP注文一覧
- **RssFOPExecutionList**: 先物OP約定一覧

## 注意事項

1. **自動更新対応**: この関数は自動更新対象です（○）
2. **ログイン必要**: 楽天証券へのログインが必要です
3. **先物OP口座必要**: 先物・オプション取引口座の開設が必要です
4. **発注IDの一意性**: 発注IDは一意である必要があります
5. **VBA関数の違い**: VBA関数は第2引数の「発注トリガー」を除いた形式です
6. **2件目の省略**: 2件目の注文は省略可能ですが、銘柄コード2を入力した場合は必須項目を全て入力
7. **注文区分の制限**: この関数では通常注文のみ可能（逆指値注文は不可）
8. **SOR注文非対応**: この関数ではSOR注文は利用できません

## パラメータの説明

### 執行数量条件
- 1:FOK (Fill or Kill) - 全量即時約定または取消
- 2:FAK (Fill and Kill) - 一部約定後、残数量取消
- 3:FAS (Fill and Store) - 一部約定後、残数量は注文として残る

### 執行時間条件
- 1:当セッション - 当日のセッション終了まで有効
- 4:引け - 引けのみ執行
- 5:期間指定 - 指定日まで有効
- 9:取引最終日 - 限月の最終取引日まで有効

## 複数注文の利点

### リスク管理
- **スプレッド取引**: 買いと売りを同時に行いリスクヘッジ
- **分散投資**: 異なる限月や権利行使価格での同時注文
- **ポートフォリオ構築**: 複数ポジションの効率的な構築

### 執行効率
- **同時発注**: 2つの注文を一度に送信
- **タイミング統一**: 注文タイミングのズレを最小化
- **操作簡便化**: 個別注文より簡単な操作

## 制限事項

### 注文数制限
- 最大2件の同時注文
- 3件以上は複数回に分けて実行

### 機能制限
- 逆指値注文は非対応
- SOR注文は非対応
- 注文区分は「0:通常注文」のみ

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF