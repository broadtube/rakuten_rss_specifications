# RssMarketHeader 完全仕様書

## 概要
**関数名**: RssMarketHeader  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 市況情報ヘッダー行作成  

**説明**: 指定された商品種類のヘッダー行（取得項目）をExcelに表示します。市況データ関数で取得可能な項目一覧を確認でき、データ取得時のヘッダー行としても使用可能です。

## 構文 (Syntax)

```excel
RssMarketHeader(商品種類, 貼り付け方向)
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 商品種類 | number | 必須 | **1**: 国内株式<br>**2**: 先物OP・指数(先物)<br>**3**: 指数(指数)<br>**4**: 為替レート |
| 2 | 貼り付け方向 | number | 任意 | **1**: 横（デフォルト）<br>**2**: 縦 |

## 商品種類別の取得項目

### 1. 国内株式（商品種類=1）
国内株式で取得可能な主要項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 銘柄名称 | 銘柄の正式名称 | string |
| 現在値 | 現在の株価 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 出来高 | 当日出来高 | number |
| VWAP | 出来高加重平均価格 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |
| 売気配 | 売り気配値 | number |
| 買気配 | 買い気配値 | number |

### 2. 先物OP・指数（先物）（商品種類=2）
先物・オプション商品の取得項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 商品名 | 商品名称 | string |
| 現在値 | 現在値 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 出来高 | 当日出来高 | number |
| 建玉 | 建玉数 | number |

### 3. 指数（指数）（商品種類=3）
指数の取得項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 指数名 | 指数名称 | string |
| 現在値 | 現在の指数値 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |

### 4. 為替レート（商品種類=4）
為替レートの取得項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 通貨ペア名 | 通貨ペア名称 | string |
| 現在値 | 現在のレート | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| Bid | 売値（ビッド） | number |
| Ask | 買値（アスク） | number |

## 使用例

### 国内株式のヘッダー行作成
```excel
=RssMarketHeader(1)
```
国内株式の出力可能項目を横方向に表示します。

### 縦方向でのヘッダー表示
```excel
=RssMarketHeader(1, 2)
```
国内株式の項目を縦方向に表示します。

### 指数のヘッダー行作成
```excel
=RssMarketHeader(3)
```
指数の出力可能項目を表示します。

### 為替レートのヘッダー行作成
```excel
=RssMarketHeader(4)
```
為替レートの出力可能項目を表示します。

## 実践的な活用例

### 1. データ取得前の項目確認
```excel
// A1セルに入力
=RssMarketHeader(1)
// 結果：銘柄名称 | 現在値 | 前日終値 | 始値 | 高値 | 安値 | ...
```

### 2. 複数銘柄の市況データ作成
```excel
// A1: ヘッダー行
=RssMarketHeader(1)

// A2以降: 各銘柄のデータ
=RssMarket("4755", "銘柄名称"), RssMarket("4755", "現在値"), RssMarket("4755", "前日終値")
=RssMarket("7203", "銘柄名称"), RssMarket("7203", "現在値"), RssMarket("7203", "前日終値")
```

## 戻り値

### 成功時の出力形式

**データ構造**: 単一行または単一列の連続セル出力
- **関数セル**: 最初の項目名
- **連続セル**: 次の項目名（貼り付け方向に依存）

### 実際の出力例

#### 国内株式のヘッダー（横方向）
```excel
=RssMarketHeader(1)
```

**出力結果** (横方向):
| A列 | B列 | C列 | D列 | E列 | F列 | G列 |
|------|------|------|------|------|------|------|
| 銀柄名称 | 現在値 | 前日終値 | 始値 | 高値 | 安値 | 出来高 |

#### 国内株式のヘッダー（縦方向）
```excel
=RssMarketHeader(1, 2)
```

**出力結果** (縦方向):
| A列 |
|------|
| 銀柄名称 |
| 現在値 |
| 前日終値 |
| 始値 |
| 高値 |
| 安値 |
| 出来高 |

#### 为替レートのヘッダー
```excel
=RssMarketHeader(4)
```

**出力結果**:
| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|------|------|------|------|------|------|------|------|
| 通貨ペア名 | 現在値 | 前日終値 | 始値 | 高値 | 安値 | Bid | Ask |

### 商品種類別出力項目一覧

#### 商品種類1：国内株式
**出力順序**：12項目
1. 銀柄名称
2. 現在値
3. 前日終値
4. 始値
5. 高値
6. 安値
7. 出来高
8. VWAP
9. 前日比
10. 前日比率
11. 売気配
12. 買気配

#### 商品種類2：先物OP・指数（先物）
**出力順序**：8項目
1. 商品名
2. 現在値
3. 前日終値
4. 始値
5. 高値
6. 安値
7. 出来高
8. 建玉

#### 商品種類3：指数（指数）
**出力順序**：8項目
1. 指数名
2. 現在値
3. 前日終値
4. 始値
5. 高値
6. 安値
7. 前日比
8. 前日比率

#### 商品種類4：为替レート
**出力順序**：8項目
1. 通貨ペア名
2. 現在値
3. 前日終値
4. 始値
5. 高値
6. 安値
7. Bid
8. Ask

### 出力セル数と範囲

| 商品種類 | 項目数 | 横方向範囲 | 縦方向範囲 |
|----------|------|----------------|----------------|
| 1 (国内株式) | 12 | A1:L1 | A1:A12 |
| 2 (先物OP) | 8 | A1:H1 | A1:A8 |
| 3 (指数) | 8 | A1:H1 | A1:A8 |
| 4 (为替) | 8 | A1:H1 | A1:A8 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#NUM!` - 商品種類の範囲外

### 特別なケース

#### 無効な商品種類
```excel
=RssMarketHeader(5)  // 1-4の範囲外
```
結果：`#NUM!`

#### 無効な貼り付け方向
```excel
=RssMarketHeader(1, 3)  // 1-2の範囲外
```
結果：`#NUM!` またはデフォルトの横方向で処理

#### パラメータ型エラー
```excel
=RssMarketHeader("文字列")  // 数値以外
```
結果：`#VALUE!`

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 商品種類、貼り付け方向の値を確認 |
| #NUM! | 商品種類の範囲外 | 1～4の範囲で指定 |

## 関連関数
- **RssMarket**: 国内株式市況情報（商品種類=1で使用）
- **RssFOPMarket**: 先物OP市況情報（商品種類=2で使用）
- **RssIndexMarket**: 指数情報（商品種類=3で使用）
- **RssFXMarket**: 為替レート情報（商品種類=4で使用）

## 注意事項

1. **商品種類の対応**: 各商品種類は対応する市況データ関数と連携使用
2. **項目の可用性**: 全ての項目が全ての銘柄で取得できるとは限りません
3. **レイアウト設計**: 貼り付け方向により表示レイアウトを調整可能
4. **データ型の理解**: 数値項目は計算に使用可能、文字列項目は表示用
5. **更新頻度**: ヘッダー項目は固定のため、リアルタイム更新は不要

## ヘッダー行の活用パターン

### 横方向レイアウト
```
銘柄名称 | 現在値 | 前日終値 | 始値 | 高値 | 安値
楽天     | 1150  | 1140    | 1145 | 1160 | 1135
トヨタ   | 8500  | 8480    | 8490 | 8520 | 8475
```

### 縦方向レイアウト
```
銘柄名称   | 楽天 | トヨタ
現在値     | 1150 | 8500
前日終値   | 1140 | 8480
始値       | 1145 | 8490
```

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「市況情報ヘッダー」