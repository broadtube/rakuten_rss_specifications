# RssMarketHeader 非公式テスト確認仕様

## 概要
**関数名**: RssMarketHeader  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 市況情報ヘッダー行作成  

**説明**: 指定された商品種類のヘッダー行（取得項目）をExcelに表示します。市況データ関数で取得可能な項目一覧を確認でき、データ取得時のヘッダー行としても使用可能です。

## 構文 (Syntax)

```excel
RssMarketHeader(商品種類, 貼り付け方向)
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 商品種類 | number | 必須 | **1**: 国内株式<br>**2**: 先物OP・指数(先物)<br>**3**: 指数(指数)<br>**4**: 為替レート |
| 2 | 貼り付け方向 | number | 任意 | **1**: 横（デフォルト）<br>**2**: 縦 |

## 商品種類別の取得項目

### 1. 国内株式（商品種類=1）
国内株式で取得可能な主要項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 銘柄名称 | 銘柄の正式名称 | string |
| 現在値 | 現在の株価 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 出来高 | 当日出来高 | number |
| VWAP | 出来高加重平均価格 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |
| 売気配 | 売り気配値 | number |
| 買気配 | 買い気配値 | number |

### 2. 先物OP・指数（先物）（商品種類=2）
先物・オプション商品の取得項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 商品名 | 商品名称 | string |
| 現在値 | 現在値 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 出来高 | 当日出来高 | number |
| 建玉 | 建玉数 | number |

### 3. 指数（指数）（商品種類=3）
指数の取得項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 指数名 | 指数名称 | string |
| 現在値 | 現在の指数値 | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |

### 4. 為替レート（商品種類=4）
為替レートの取得項目：

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 通貨ペア名 | 通貨ペア名称 | string |
| 現在値 | 現在のレート | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| Bid | 売値（ビッド） | number |
| Ask | 買値（アスク） | number |

## 使用例

### 国内株式のヘッダー行作成
```excel
=RssMarketHeader(1)
```
国内株式の出力可能項目を横方向に表示します。

### 縦方向でのヘッダー表示
```excel
=RssMarketHeader(1, 2)
```
国内株式の項目を縦方向に表示します。

### 指数のヘッダー行作成
```excel
=RssMarketHeader(3)
```
指数の出力可能項目を表示します。

### 為替レートのヘッダー行作成
```excel
=RssMarketHeader(4)
```
為替レートの出力可能項目を表示します。

## 実践的な活用例

### 1. データ取得前の項目確認
```excel
// A1セルに入力
=RssMarketHeader(1)
// 結果：銘柄名称 | 現在値 | 前日終値 | 始値 | 高値 | 安値 | ...
```

### 2. 複数銘柄の市況データ作成
```excel
// A1: ヘッダー行
=RssMarketHeader(1)

// A2以降: 各銘柄のデータ
=RssMarket("4755", "銘柄名称"), RssMarket("4755", "現在値"), RssMarket("4755", "前日終値")
=RssMarket("7203", "銘柄名称"), RssMarket("7203", "現在値"), RssMarket("7203", "前日終値")
```

## 戻り値

### 成功時の出力形式

**データ構造**: 単一行または単一列の連続セル出力
- **関数セル**: 最初の項目名
- **連続セル**: 次の項目名（貼り付け方向に依存）

### 実際の出力例

#### 国内株式のヘッダー（横方向）
```excel
=RssMarketHeader(1)
```

**出力結果** (横方向):
| A列 | B列 | C列 | D列 | E列 | F列 | G列 |
|------|------|------|------|------|------|------|
| 銘柄コード | 市場コード | 銘柄名称 | 市場名称 | 市場部名称 | ... | （実際は85～150項目） |

#### 国内株式のヘッダー（縦方向）
```excel
=RssMarketHeader(1, 2)
```

**出力結果** (縦方向):
| A列 |
|------|
| 銘柄コード |
| 現在値 |
| 前日終値 |
| 始値 |
| 高値 |
| 安値 |
| 出来高 |

#### 為替レートのヘッダー
```excel
=RssMarketHeader(4)
```

**出力結果**:
| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|------|------|------|------|------|------|------|------|
| 通貨コード1 | 通貨コード2 | 通貨名称1 | 通貨名称2 | 現在値(Bid) | 現在値(Ask) | ... | （実際は21項目） |

### 商品種類別出力項目一覧

#### 商品種類1：国内株式
**実際の出力項目数**：148項目（実機テストで確認）

**完全な項目リスト**（出力順）：
1. 銘柄コード
2. 市場コード
3. 銘柄名称
4. 市場名称
5. 市場部名称
6. 市場部略称
7. 現在日付
8. 現在値
9. 現在値時刻
10. 現在値詳細時刻
11. 現在値ティック
12. 現在値フラグ
13. 前日比
14. 前日比率
15. 前日終値
16. 前日日付
17. 前日終値フラグ
18. 歩み1
19. 歩み2
20. 歩み3
21. 歩み4
22. 歩み1詳細時刻
23. 歩み2詳細時刻
24. 歩み3詳細時刻
25. 歩み4詳細時刻
26. 出来高
27. 売買代金
28. 出来高加重平均
29. 時価総額
30. 始値
31. 高値
32. 安値
33. 始値時刻
34. 高値時刻
35. 安値時刻
36. 始値詳細時刻
37. 高値詳細時刻
38. 安値詳細時刻
39. 前場始値
40. 前場高値
41. 前場安値
42. 前場終値
43. 前場出来高
44. 後場始値
45. 後場高値
46. 後場安値
47. 前場始値時刻
48. 前場高値時刻
49. 前場安値時刻
50. 前場終値時刻
51. 前場出来高時刻
52. 後場始値時刻
53. 後場高値時刻
54. 後場安値時刻
55. 最良売気配値
56. 最良買気配値
57. 最良売気配数量
58. 最良買気配数量
59. 最良売気配時刻
60. 最良買気配時刻
61. 最良売気配詳細時刻
62. 最良買気配詳細時刻
63. 特別売気配フラグ
64. 特別買気配フラグ
65. 信用貸借区分
66. 逆日歩
67. 逆日歩更新日付
68. 信用売残
69. 信用売残前週比
70. 信用買残
71. 信用買残前週比
72. 信用倍率
73. 証金残更新日付
74. 新規貸株
75. 新規融資
76. 返済貸株
77. 返済融資
78. 残高貸株
79. 残高融資
80. 残高差引
81. 前日比貸株
82. 前日比融資
83. 前日比差引
84. 回転日数
85. 貸借倍率
86. 最良売気配値1
87. 最良売気配値2
88. 最良売気配値3
89. 最良売気配値4
90. 最良売気配値5
91. 最良売気配値6
92. 最良売気配値7
93. 最良売気配値8
94. 最良売気配値9
95. 最良売気配値10
96. 最良買気配値1
97. 最良買気配値2
98. 最良買気配値3
99. 最良買気配値4
100. 最良買気配値5
101. 最良買気配値6
102. 最良買気配値7
103. 最良買気配値8
104. 最良買気配値9
105. 最良買気配値10
106. 最良売気配数量1
107. 最良売気配数量2
108. 最良売気配数量3
109. 最良売気配数量4
110. 最良売気配数量5
111. 最良売気配数量6
112. 最良売気配数量7
113. 最良売気配数量8
114. 最良売気配数量9
115. 最良売気配数量10
116. 最良買気配数量1
117. 最良買気配数量2
118. 最良買気配数量3
119. 最良買気配数量4
120. 最良買気配数量5
121. 最良買気配数量6
122. 最良買気配数量7
123. 最良買気配数量8
124. 最良買気配数量9
125. 最良買気配数量10
126. 売成行数量
127. 買成行数量
128. OVER気配数量
129. UNDER気配数量
130. 単位株数
131. 配当
132. 配当落日
133. 中配落日
134. 権利落日
135. 決算発表日
136. PER
137. PBR
138. 当日基準値
139. 年初来高値
140. 年初来安値
141. 年初来高値日付
142. 年初来安値日付
143. 上場来高値
144. 上場来安値
145. 上場来高値日付
146. 上場来安値日付
147. 貸株金利
148. 貸株金利適用日

#### 商品種類2：先物OP・指標（先物）
**実際の出力項目数**：125項目（実機テストで確認）

**完全な項目リスト**（出力順）：
1. 銘柄コード
2. 市場コード
3. 銘柄名称
4. 限月
5. CP区分
6. 権利行使価格
7. 市場名称
8. 現在日付
9. 現在値
10. 現在値時刻
11. 現在値詳細時刻
12. 現在値ティック
13. 現在値フラグ
14. 前日比
15. 前日比率
16. 前日終値
17. 前日日付
18. 前日終値フラグ
19. 建玉
20. 建玉日付
21. 建玉前日比
22. 歩み1
23. 歩み2
24. 歩み3
25. 歩み4
26. 歩み1時刻
27. 歩み2時刻
28. 歩み3時刻
29. 歩み4時刻
30. 歩み1詳細時刻
31. 歩み2詳細時刻
32. 歩み3詳細時刻
33. 歩み4詳細時刻
34. 出来高
35. 売買代金
36. 出来高加重平均
37. IV
38. デルタ
39. ガンマ
40. ベガ
41. セータ
42. ロー
43. 始値
44. 高値
45. 安値
46. 始値日付
47. 高値日付
48. 安値日付
49. 始値時刻
50. 高値時刻
51. 安値時刻
52. 始値詳細時刻
53. 高値詳細時刻
54. 安値詳細時刻
55. 日中始値
56. 日中高値
57. 日中安値
58. 日中始値時刻
59. 日中高値時刻
60. 日中安値時刻
61. 夕場始値
62. 夕場高値
63. 夕場安値
64. 夕場終値
65. 夕場出来高
66. 夕場始値日付
67. 夕場高値日付
68. 夕場安値日付
69. 夕場終値日付
70. 夕場始値時刻
71. 夕場高値時刻
72. 夕場安値時刻
73. 夕場終値時刻
74. 夕場出来高時刻
75. 最良売気配値1
76. 最良売気配値2
77. 最良売気配値3
78. 最良売気配値4
79. 最良売気配値5
80. 最良売気配値6
81. 最良売気配値7
82. 最良売気配値8
83. 最良売気配値9
84. 最良売気配値10
85. 最良買気配値1
86. 最良買気配値2
87. 最良買気配値3
88. 最良買気配値4
89. 最良買気配値5
90. 最良買気配値6
91. 最良買気配値7
92. 最良買気配値8
93. 最良買気配値9
94. 最良買気配値10
95. 最良売気配数量1
96. 最良売気配数量2
97. 最良売気配数量3
98. 最良売気配数量4
99. 最良売気配数量5
100. 最良売気配数量6
101. 最良売気配数量7
102. 最良売気配数量8
103. 最良売気配数量9
104. 最良売気配数量10
105. 最良買気配数量1
106. 最良買気配数量2
107. 最良買気配数量3
108. 最良買気配数量4
109. 最良買気配数量5
110. 最良買気配数量6
111. 最良買気配数量7
112. 最良買気配数量8
113. 最良買気配数量9
114. 最良買気配数量10
115. 売買最終日
116. 残存日数
117. 当社最終決済日
118. サイズ
119. 清算値
120. 前SQ
121. 限月高値
122. 限月安値
123. 限月高値日付
124. 限月安値日付
125. サーキットブレーカー

#### 商品種類3：指標（指数）
**実際の出力項目数**：27項目（実機テストで確認）

**完全な項目リスト**（出力順）：
1. 指標コード
2. 指標名称
3. 現在日付
4. 更新時刻
5. 現在値
6. 現在値ティック
7. 前日比
8. 前日比率
9. 前日終値
10. 前日日付
11. 始値
12. 高値
13. 安値
14. 始値時刻
15. 高値時刻
16. 安値時刻
17. 出来高
18. 売買代金
19. 前年最高値
20. 前年最安値
21. 前年終値
22. 年初来高値
23. 年初来安値
24. 上場来高値
25. 上場来安値
26. 上場来高値日付
27. 上場来安値日付

#### 商品種類4：為替レート
**実際の出力項目数**：21項目（実機テストで確認）

**完全な項目リスト**（出力順）：
1. 通貨コード1
2. 通貨コード2
3. 通貨名称1
4. 通貨名称2
5. 現在値(Bid)
6. 現在値(Ask)
7. 現在値更新日時
8. 前日比(Bid)
9. 前日終値(Bid)
10. 始値(Bid)
11. 高値(Bid)
12. 高値更新時刻(Bid)
13. 安値(Bid)
14. 安値更新時刻(Bid)
15. 前日比(Ask)
16. 前日終値(Ask)
17. 始値(Ask)
18. 高値(Ask)
19. 高値更新時刻(Ask)
20. 安値(Ask)
21. 安値更新時刻(Ask)

### 出力セル数と範囲

| 商品種類 | 実際の項目数 | 横方向範囲 | 縦方向範囲 |
|----------|------|----------------|----------------|
| 1 (国内株式) | 148 | A1:ER1 | A1:A148 |
| 2 (先物OP) | 125 | A1:DU1 | A1:A125 |
| 3 (指標) | 27 | A1:AA1 | A1:A27 |
| 4 (為替) | 21 | A1:U1 | A1:A21 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#NUM!` - 商品種類の範囲外

### 特別なケース

#### 無効な商品種類
```excel
=RssMarketHeader(5)  // 1-4の範囲外
```
結果：`#NUM!`

#### 無効な貼り付け方向
```excel
=RssMarketHeader(1, 3)  // 1-2の範囲外
```
結果：`#NUM!` またはデフォルトの横方向で処理

#### パラメータ型エラー
```excel
=RssMarketHeader("文字列")  // 数値以外
```
結果：`#VALUE!`

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 商品種類、貼り付け方向の値を確認 |
| #NUM! | 商品種類の範囲外 | 1～4の範囲で指定 |

## 関連関数
- **RssMarket**: 国内株式市況情報（商品種類=1で使用）
- **RssFOPMarket**: 先物OP市況情報（商品種類=2で使用）
- **RssIndexMarket**: 指数情報（商品種類=3で使用）
- **RssFXMarket**: 為替レート情報（商品種類=4で使用）

## 重要な注意事項

### 項目数について
**重要**: 本ドキュメントに記載の項目数は、実機テスト（2025年8月30日実施）から確認された実際の値です。以前のバージョンで記載されていた「12項目」「8項目」などは誤りでした。

1. **国内株式（商品種類=1）**: 実測148項目
2. **先物OP・指標（先物）（商品種類=2）**: 実測125項目
3. **指標（指数）（商品種類=3）**: 実測27項目
4. **為替レート（商品種類=4）**: 実測21項目

### その他の注意事項

1. **商品種類の対応**: 各商品種類は対応する市況データ関数と連携使用
2. **項目の可用性**: 全ての項目が全ての銘柄で取得できるとは限りません
3. **レイアウト設計**: 貼り付け方向により表示レイアウトを調整可能
4. **データ型の理解**: 数値項目は計算に使用可能、文字列項目は表示用
5. **更新頻度**: ヘッダー項目は固定のため、リアルタイム更新は不要
6. **配列項目**: 最良売気配値1-10、最良買気配値1-10などは配列として展開されるため、実際の出力セル数は多くなります

## ヘッダー行の活用パターン

### 横方向レイアウト
```
銘柄名称 | 現在値 | 前日終値 | 始値 | 高値 | 安値
楽天     | 1150  | 1140    | 1145 | 1160 | 1135
トヨタ   | 8500  | 8480    | 8490 | 8520 | 8475
```

### 縦方向レイアウト
```
銘柄名称   | 楽天 | トヨタ
現在値     | 1150 | 8500
前日終値   | 1140 | 8480
始値       | 1145 | 8490
```

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2025年8月30日
- 修正内容: 実機テストにより正確な項目数を確認・反映（全項目を省略なしで記載）
  - 国内株式: 148項目（実測）
  - 先物OP: 125項目（実測）
  - 指標: 27項目（実測）
  - 為替: 21項目（実測）

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「市況情報ヘッダー」