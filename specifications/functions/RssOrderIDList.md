# RssOrderIDList 非公式テスト確認仕様

## 概要
**関数名**: RssOrderIDList  
**カテゴリ**: 注文管理 (Order Management)  
**用途**: 発注ID一覧の取得  

**説明**: 現在使用中の発注IDの一覧をExcelに表示します。発注ID管理や重複回避に活用でき、注文の自動化処理で重要な役割を果たします。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssOrderIDList(ヘッダー行)
```

### VBA関数
```vb
RssOrderIDList_V(ヘッダー行)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | ヘッダー行 | △ | セル参照 | 取得項目が入力されているセル範囲を指定します<br>省略時はすべての取得項目を表示します |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な発注ID一覧取得
```excel
=RssOrderIDList()
```
全ての発注ID情報を取得（ヘッダー行省略）

### ヘッダー行指定での取得
```excel
=RssOrderIDList(A1:F1)
```
A1:F1セルにヘッダー項目を設定して、必要な項目のみを取得

### 特定項目のみ取得
```excel
// A5:C5に必要な項目名を入力
A5: 発注ID
B5: 関数名
C5: 発注結果
=RssOrderIDList(A5:C5)
```

## 戻り値

### 成功時の出力形式

**データ構造**: 一覧形式
- **ヘッダー行**: 項目名（省略時は自動生成）
- **データ行**: 各発注IDの情報

### 出力項目

| No | 項目名 | データ型 | 説明 |
|----|--------|----------|------|
| 1 | 発注ID | string | 発注IDを表示 |
| 2 | 関数名 | string | 関数名を表示 |
| 3 | 発注日 | string | 発注日を表示（年月日:YYYY/MM/DD） |
| 4 | 発注時刻 | string | 発注時刻を表示（時分秒:HH:MM:SS） |
| 5 | 注文番号 | string | 発注した注文番号を表示 |
| 6 | 発注結果 | string | 発注結果を表示 |

### 実際の出力例

#### ヘッダー行省略の場合
```excel
=RssOrderIDList()
```
結果：
```
発注ID    関数名              発注日        発注時刻      注文番号    発注結果
1        RssStockOrder      2024/12/01    09:00:15     12345      成功
2        RssMarginOpenOrder 2024/12/01    09:30:22     12346      成功
3        RssFOPOrder        2024/12/01    10:15:00     12347      失敗
```

#### ヘッダー行指定の場合
```excel
// A1:C1にヘッダー項目を入力
A1: 発注ID
B1: 関数名
C1: 発注結果
=RssOrderIDList(A1:C1)
```
結果：
```
発注ID    関数名              発注結果
1        RssStockOrder      成功
2        RssMarginOpenOrder 成功
3        RssFOPOrder        失敗
```

### 失敗時の出力

**可能なエラー**:
- `ヘッダー行に有効な項目名が存在しません。` - ヘッダー行に正しい項目名がない
- `ヘッダー行は、単一行のセル範囲で入力してください。` - ヘッダー行形式エラー
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - ログインエラー、サービス利用不可

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| ヘッダー行に有効な項目名が存在しません | ヘッダー行に正しい項目名がない | 正しい項目名を指定 |
| ヘッダー行は、単一行のセル範囲で入力してください | ヘッダー行形式エラー | 単一行のセル範囲を指定 |
| #VALUE! | パラメータ形式エラー | パラメータの型と値を確認 |
| #N/A | ログインエラー | ログイン状況を確認 |

## 活用例

### 発注ID管理
```excel
// A1に関数を配置
=RssOrderIDList()

// 発注IDの使用状況を確認
// COUNTIF関数で特定の関数名の使用数をカウント
=COUNTIF(B:B,"RssStockOrder")
```

### VBAでの活用
```vb
Sub CheckOrderIDs()
    Dim orderData As Variant
    
    ' ヘッダー行を省略して全項目取得
    orderData = Application.WorksheetFunction.RssOrderIDList_V()
    
    ' 発注結果を確認
    Dim i As Long
    For i = 2 To UBound(orderData, 1)
        If orderData(i, 6) = "失敗" Then
            MsgBox "発注ID " & orderData(i, 1) & " が失敗しています"
        End If
    Next i
End Sub
```

## 関連関数
- **RssOrderList**: 注文一覧
- **RssOrderStatus**: 注文状況取得
- **RssStockOrder**: 現物注文
- **RssMarginOpenOrder**: 信用新規注文

## 注意事項

1. **自動更新なし**: この関数は自動更新対象外です（-）
2. **ログイン必要**: 楽天証券へのログインが必要です
3. **発注IDの管理**: 発注IDは一意である必要があります
4. **同時使用制限**: 同じ発注IDを複数の注文で同時に使用することはできません
5. **項目名の正確性**: ヘッダー行を指定する場合は項目名を正確に入力する必要があります

## 項目の説明

### 発注ID
- 注文を識別するための一意のID
- 数値または文字列で指定可能

### 関数名
- 発注に使用された関数名
- RssStockOrder、RssMarginOpenOrder等

### 発注日・発注時刻
- 注文が発注された日時
- 日付はYYYY/MM/DD形式
- 時刻はHH:MM:SS形式

### 注文番号
- 楽天証券が割り当てた注文番号
- 注文の追跡に使用

### 発注結果
- 成功: 注文が正常に受け付けられた
- 失敗: 注文がエラーにより受け付けられなかった

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF