# RssOrderStatus 非公式テスト確認仕様

## 概要
**関数名**: RssOrderStatus  
**カテゴリ**: 注文管理 (Order Management)  
**用途**: 注文状況取得  

**説明**: 発注IDごとの注文状況を表示します。発注IDを指定して、その注文の現在の状態を数値（ステータスID）で取得する単項目関数です。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssOrderStatus(発注ID)
```

### VBA関数
```vb
RssOrderStatus_V(発注ID)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 発注ID | ● | number | 注文状況を取得したい発注IDを指定します<br>1以上2147483647以下の整数値 |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な注文状況確認
```excel
=RssOrderStatus(1)
```
発注ID=1の注文状況を取得

### 複数の注文状況確認
```excel
// A列に発注IDを入力、B列に状況を表示
B1: =RssOrderStatus(A1)
B2: =RssOrderStatus(A2)
B3: =RssOrderStatus(A3)
```

### 条件付き状況確認
```excel
=IF(RssOrderStatus(100)=3, "約定済み", IF(RssOrderStatus(100)=2, "有効", "無効"))
```
発注ID=100の状況を文字列で表示

## 戻り値

### 成功時の出力形式

**データ構造**: 単項目（単一値）
- **戻り値**: ステータスIDを示す数値（-1, 1, 2, 3のいずれか）

### ステータスIDの詳細

| ステータスID | 意味 | 説明 |
|-------------|------|------|
| -1 | 該当なし | 指定した発注IDから注文明細が取得できない場合 |
| 1 | 無効 | 出来ず、取消済等、既に無効な状態 |
| 2 | 有効 | 執行中、出来有、待機中等、指定の注文が生きている状態 |
| 3 | 約定 | 全数量が約定した状態 |

### 実際の出力例

```excel
=RssOrderStatus(123)
```
結果：`2` （有効な注文）

```excel
=RssOrderStatus(456)
```
結果：`3` （約定済み）

```excel
=RssOrderStatus(789)
```
結果：`1` （取消済みまたは無効）

```excel
=RssOrderStatus(999999)
```
結果：`-1` （該当する発注IDなし）

### 失敗時の出力

**可能なエラー**:
- `発注IDを入力してください。` - 発注IDが0以下または省略された場合
- `#VALUE!` - パラメータ形式エラー（文字列等）
- `-2146826273` - パラメータ数エラー（複数パラメータ）

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| 発注IDを入力してください | 発注IDが無効または省略 | 1以上の有効な発注IDを指定 |
| #VALUE! | パラメータ形式エラー | 数値型の発注IDを指定 |
| -2146826273 | パラメータ数エラー | パラメータは1つのみ指定 |

## 活用例

### 注文監視システム
```excel
// 発注IDリストの状況を一括確認
// A列: 発注ID
// B列: ステータス値
// C列: ステータス文字列

C1: =CHOOSE(B1+2, "該当なし", "", "無効", "有効", "約定")
```

### 約定待ちカウント
```excel
// 複数の発注IDの有効注文数をカウント
=COUNTIF(B:B, 2)  // B列にRssOrderStatusの結果がある場合
```

### 自動アラート
```excel
// 約定したらアラート表示
=IF(RssOrderStatus(A1)=3, "約定完了！", "")
```

### VBAでの活用
```vb
Sub CheckOrderStatus()
    Dim orderID As Long
    Dim status As Integer
    
    orderID = 123
    status = Application.WorksheetFunction.RssOrderStatus_V(orderID)
    
    Select Case status
        Case -1
            MsgBox "発注IDが見つかりません"
        Case 1
            MsgBox "注文は無効です"
        Case 2
            MsgBox "注文は有効です"
        Case 3
            MsgBox "約定済みです"
    End Select
End Sub
```

## 関連関数
- **RssOrderIDList**: 発注ID一覧（使用済み発注IDの確認）
- **RssOrderList**: 注文一覧（詳細情報の取得）
- **RssExecutionList**: 約定一覧
- **RssStockOrder**: 現物注文（発注ID生成）
- **RssMarginOpenOrder**: 信用新規注文（発注ID生成）
- **RssCancelOrder**: 注文取消
- **RssModifyOrder**: 注文訂正

## 注意事項

1. **単項目関数**: この関数は単一の値（ステータスID）のみを返します
2. **発注ID管理**: 発注IDは注文発行時に指定した固有の番号です
3. **リアルタイム更新**: 注文状況はリアルタイムで更新されます
4. **ログイン必要**: 楽天証券へのログインが必要です
5. **自動更新**: この関数は自動更新対象です（○）
6. **発注IDの有効範囲**: 1以上2147483647以下の整数値
7. **戻り値の型**: 数値型（-1, 1, 2, 3）のみ

## 発注IDとは

発注IDは、RSS関数から注文を発行する際に、ユーザーが任意に指定する識別番号です：
- 注文発行時に指定（RssStockOrder等の第1引数）
- 同一の発注IDは再利用不可
- 注文の追跡・管理に使用
- RssOrderIDListで使用済みIDを確認可能

## ステータス遷移

```
新規注文 → 2（有効）
    ↓
部分約定 → 2（有効のまま）
    ↓
全部約定 → 3（約定）

または

新規注文 → 2（有効）
    ↓
取消実行 → 1（無効）
```

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF