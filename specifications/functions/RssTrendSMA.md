# RssTrendSMA 非公式テスト確認仕様

## 概要
**関数名**: RssTrendSMA  
**カテゴリ**: チャート・テクニカル分析 (Chart & Technical Analysis)  
**用途**: 移動平均線データの取得  

**説明**: 指定した銘柄の移動平均線（SMA：Simple Moving Average）データをExcelに表示します。複数期間の移動平均線を同時に取得でき、テクニカル分析に活用できます。

## 構文 (Syntax)

### Excel ワークシート関数
```excel
RssTrendSMA(引数列, ヘッダー行, 銘柄コード, 足種, 期間1, 期間2, 期間3, 期間4, 期間5, 表示本数)
```

### VBA関数
```vb
RssTrendSMA_V(引数列, ヘッダー行, 銘柄コード, 足種, 期間1, 期間2, 期間3, 期間4, 期間5, 表示本数)
```

## パラメータ詳細

| No | パラメータ名 | 必要性 | データ型 | 説明 |
|----|------------|--------|----------|------|
| 1 | 引数列 | ● | number | データ列の開始位置を指定する数値 |
| 2 | ヘッダー行 | ● | number | ヘッダー行の位置を指定する数値 |
| 3 | 銘柄コード | ● | string | 4-5桁英数字の銘柄コード<br>「.市場」は省略可（.T:東証, .JAX:JASDAQ, .JNX:JNX） |
| 4 | 足種 | ● | string | チャートの時間軸を指定<br>「D」:日足, 「W」:週足, 「M」:月足, 「5」:5分足, 「15」:15分足, 「30」:30分足, 「60」:60分足 |
| 5 | 期間1 | ● | number | 1番目の移動平均期間（1-200） |
| 6 | 期間2 | △ | number | 2番目の移動平均期間（1-200、省略可） |
| 7 | 期間3 | △ | number | 3番目の移動平均期間（1-200、省略可） |
| 8 | 期間4 | △ | number | 4番目の移動平均期間（1-200、省略可） |
| 9 | 期間5 | △ | number | 5番目の移動平均期間（1-200、省略可） |
| 10 | 表示本数 | ● | number | 取得するデータの本数（最大200本） |

**凡例**: ● 必須, △ 省略可, ▲ 条件次第で省略可, - 指定不要

## 使用例

### 基本的な移動平均線取得
```excel
=RssTrendSMA(A1, 1, "4755", "D", 5, 25, 75, , , 50)
```
楽天グループ（4755）の日足で5日・25日・75日移動平均線を50本取得

### 短期移動平均線の取得
```excel
=RssTrendSMA(C1, 1, "7203", "D", 5, 10, 20, , , 30)
```
トヨタ自動車（7203）の日足で5日・10日・20日移動平均線を30本取得

### 分足での移動平均線取得
```excel
=RssTrendSMA(A5, 2, "9984", "60", 20, 60, , , , 100)
```
ソフトバンクグループ（9984）の60分足で20期間・60期間移動平均線を100本取得

### 5本すべての期間を指定
```excel
=RssTrendSMA(A1, 1, "6758", "D", 5, 10, 20, 50, 100, 80)
```
ソニーグループ（6758）の日足で5・10・20・50・100日移動平均線を80本取得

## 戻り値

### 成功時の出力形式

**データ構造**: マトリクス形式（配列）
- **ヘッダ行**: 項目名（日付、終値、SMA期間1、SMA期間2、SMA期間3、SMA期間4、SMA期間5）
- **データ行**: 各足の終値と移動平均線データ

### 実際の出力例

#### 3期間移動平均線の出力
```excel
=RssTrendSMA(A1, 1, "4755", "D", 5, 25, 75, , , 5)
```

| 日付 | 終値 | SMA5 | SMA25 | SMA75 |
|------|------|------|-------|-------|
| 20240508 | 1140 | 1125.0 | 1098.5 | 1089.2 |
| 20240507 | 1100 | 1118.0 | 1095.8 | 1087.8 |
| 20240506 | 1095 | 1110.0 | 1092.4 | 1086.1 |
| 20240502 | 1080 | 1105.0 | 1089.2 | 1084.5 |
| 20240501 | 1075 | 1098.0 | 1086.8 | 1082.9 |

#### 分足移動平均線の出力
```excel
=RssTrendSMA(A10, 1, "7203", "60", 20, 60, , , , 3)
```

| 日付時刻 | 終値 | SMA20 | SMA60 |
|----------|------|-------|-------|
| 202405081100 | 2505 | 2498.5 | 2485.2 |
| 202405081000 | 2500 | 2495.8 | 2483.8 |
| 202405080900 | 2495 | 2493.2 | 2482.1 |

### データ項目の詳細

| 項目 | データ型 | 説明 |
|------|----------|------|
| 日付/日付時刻 | string | YYYYMMDD形式（日足）またはYYYYMMDDHHMM形式（分足） |
| 終値 | number | その期間の終了価格（移動平均算出の基準値） |
| SMA期間N | number | N期間単純移動平均値（小数点以下1桁） |

### 移動平均算出ルール

1. **単純移動平均**: 指定期間の終値の平均値
2. **算出開始**: 指定期間以降のデータから有効値を表示
3. **データ不足**: 期間に満たない場合は空白またはエラー
4. **精度**: 小数点以下1桁で表示

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銘柄コード無効、データ不足
- `#NUM!` - 期間パラメータの範囲外
- `#REF!` - セル参照エラー

### 特別なケース

#### 期間が長すぎる場合
```excel
=RssTrendSMA(A1, 1, "4755", "D", 300, , , , , 10)  // 300日移動平均
```
結果：`#NUM!`

#### データ不足による移動平均未算出
```excel
=RssTrendSMA(A1, 1, "4755", "D", 100, , , , , 50)  // 100日移動平均を50本
```
結果：期間不足部分は空白で表示

#### 無効な足種指定
```excel
=RssTrendSMA(A1, 1, "4755", "2", 5, , , , , 10)  // 2分足（未対応）
```
結果：`#VALUE!`

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー、足種指定不正 | パラメータの型と値、足種指定を確認 |
| #N/A | 銘柄コード無効、データなし | 銘柄コード、データ期間を確認 |
| #NUM! | 期間パラメータの範囲外（1-200外） | 期間を1-200の範囲で指定 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssChart**: チャート情報（4本値）
- **RssChartPast**: 過去チャート情報
- **RssMarket**: リアルタイム市況データ
- **RssTickList**: ティック（歩み値）データ

## 注意事項

1. **期間制限**: 移動平均期間は1-200の範囲で指定してください
2. **データ必要量**: 移動平均期間以上のデータが必要です
3. **足種対応**: 一部の分足のみ対応（1分、3分足は未対応）
4. **算出精度**: 小数点以下1桁で表示されます
5. **空白表示**: データ不足の期間は空白で表示されます

## 対応足種

### 対応足種一覧
| 足種 | 説明 | データ期間 |
|------|------|-----------|
| D | 日足 | 約3年分 |
| W | 週足 | 約5年分 |
| M | 月足 | 約10年分 |
| 5 | 5分足 | 当日+前営業日 |
| 15 | 15分足 | 当日+前営業日 |
| 30 | 30分足 | 当日+前営業日 |
| 60 | 60分足 | 当日+前営業日 |

### 未対応足種
- 1分足、3分足、10分足は非対応

## 移動平均期間の推奨設定

### 短期分析
- **5日、10日、20日**: デイトレード、短期投資向け
- **5期間、10期間、20期間**: 分足での短期分析

### 中期分析
- **25日、50日、75日**: スイングトレード向け
- **20期間、50期間、100期間**: 中期トレンド分析

### 長期分析
- **100日、200日**: 長期投資、トレンド確認
- **月足での12期間、24期間**: 長期トレンド分析

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- 楽天証券 RSS関数マニュアル PDF