# RssFXMarket 非公式テスト確認仕様

## 概要
**関数名**: RssFXMarket  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 為替レート情報の取得  

**説明**: 指定された為替レートの情報をExcelに表示します。主要通貨ペアのリアルタイム為替レートデータを取得できます。

## 構文 (Syntax)

```excel
RssFXMarket("為替レート", "取得項目")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | 為替レート | string | 必須 | 通貨ペアコード（下記コード表参照） |
| 2 | 取得項目 | string | 必須 | 為替情報の取得項目名 |

## 主要な通貨ペアコード

| 通貨ペアコード | 通貨ペア名 | 説明 |
|----------------|------------|------|
| USDJPY | 米ドル/円 | USD/JPY |
| EURJPY | ユーロ/円 | EUR/JPY |
| GBPJPY | 英ポンド/円 | GBP/JPY |
| AUDJPY | 豪ドル/円 | AUD/JPY |
| CADJPY | カナダドル/円 | CAD/JPY |
| CHFJPY | スイスフラン/円 | CHF/JPY |
| NZDJPY | NZドル/円 | NZD/JPY |
| EURUSD | ユーロ/米ドル | EUR/USD |
| GBPUSD | 英ポンド/米ドル | GBP/USD |
| AUDUSD | 豪ドル/米ドル | AUD/USD |

## 主要な取得項目

| 項目名 | 説明 | データ型 |
|--------|------|----------|
| 現在値 | 現在の為替レート | number |
| 前日終値 | 前日終値 | number |
| 始値 | 当日始値 | number |
| 高値 | 当日高値 | number |
| 安値 | 当日安値 | number |
| 前日比 | 前日比 | number |
| 前日比率 | 前日比率(%) | number |
| Bid | 売値（ビッド） | number |
| Ask | 買値（アスク） | number |

## 使用例

### 基本的な使用方法
```excel
=RssFXMarket("USDJPY", "現在値")
```
ドル円レートの現在値を表示します。

### 複数通貨の監視
```excel
=RssFXMarket("USDJPY", "現在値")  // ドル円
=RssFXMarket("EURJPY", "現在値")  // ユーロ円
=RssFXMarket("GBPJPY", "現在値")  // ポンド円
=RssFXMarket("AUDJPY", "現在値")  // 豪ドル円
```

### 為替レートの詳細情報
```excel
=RssFXMarket("USDJPY", "始値")
=RssFXMarket("USDJPY", "高値")
=RssFXMarket("USDJPY", "安値")
=RssFXMarket("USDJPY", "前日比")
```
ドル円レートの各種データを取得します。

### ビッド・アスクの取得
```excel
=RssFXMarket("EURUSD", "Bid")    // ユーロドルの売値
=RssFXMarket("EURUSD", "Ask")    // ユーロドルの買値
```

### セル参照での使用
A1セルに通貨ペア「USDJPY」、B1セルに「現在値」が入力されている場合：
```excel
=RssFXMarket(A1, B1)
```

## 戻り値

### 成功時の出力形式

**データ構造**: 単一セル
- **関数セル**: 指定した取得項目の値

### 実際の出力例

#### ドル円レートの現在値
```excel
=RssFXMarket("USDJPY", "現在値")
```
結果：`150.25` （数値、小数点以下2桁まで）

#### ユーロドルのBid/Ask
```excel
=RssFXMarket("EURUSD", "Bid")
```
結果：`1.0895` （数値、小数点以下4桁まで）

```excel
=RssFXMarket("EURUSD", "Ask")
```
結果：`1.0898` （数値、小数点以下4桁まで）

#### 前日比の取得
```excel
=RssFXMarket("USDJPY", "前日比")
```
結果：`+1.25` （数値、±表記）

#### 前日比率の取得
```excel
=RssFXMarket("GBPJPY", "前日比率")
```
結果：`0.75` （数値、%記号なし）

### 取得項目別の値範囲・形式

| 取得項目 | データ型 | 値の範囲・形式 | 例 | 備考 |
|----------|----------|----------------|-----|------|
| 現在値 | number | 正数（為替レート）<br>小数点桁数は通貨ペア依存 | `150.25`, `1.0895` | 通貨単位 |
| 前日終値 | number | 正数（為替レート） | `149.80`, `1.0875` | 前営業日終値 |
| 始値 | number | 正数（為替レート） | `149.95`, `1.0880` | 当日始値 |
| 高値 | number | 正数（為替レート） | `150.50`, `1.0920` | 当日高値 |
| 安値 | number | 正数（為替レート） | `149.75`, `1.0870` | 当日安値 |
| 前日比 | number | 実数（±） | `+0.45`, `-0.15` | 前日終値からの差 |
| 前日比率 | number | 実数（%） | `0.30`, `-0.14` | パーセント値（%記号なし） |
| Bid | number | 正数（売値） | `150.23`, `1.0893` | ビッド価格 |
| Ask | number | 正数（買値） | `150.27`, `1.0896` | アスク価格 |

### 通貨ペア別の値範囲・精度参考

| 通貨ペアコード | 通貨ペア名 | 一般的な値範囲 | 小数点桁数 | スプレッド目安 |
|----------------|------------|----------------|------------|---------------|
| USDJPY | 米ドル/円 | 100-160程度 | 小数点以下2桁 | 0.02-0.05円 |
| EURJPY | ユーロ/円 | 120-170程度 | 小数点以下2桁 | 0.03-0.08円 |
| GBPJPY | 英ポンド/円 | 140-200程度 | 小数点以下2桁 | 0.05-0.15円 |
| AUDJPY | 豪ドル/円 | 70-110程度 | 小数点以下2桁 | 0.03-0.10円 |
| EURUSD | ユーロ/米ドル | 0.95-1.25程度 | 小数点以下4桁 | 0.0001-0.0003 |
| GBPUSD | 英ポンド/米ドル | 1.15-1.45程度 | 小数点以下4桁 | 0.0002-0.0005 |
| AUDUSD | 豪ドル/米ドル | 0.60-0.85程度 | 小数点以下4桁 | 0.0001-0.0004 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 通貨ペアコード無効、市場休場等
- `#REF!` - セル参照エラー

### 特別なケース

#### 市場休場時
```excel
=RssFXMarket("USDJPY", "現在値")
```
結果：`#N/A` または前営業日終値

#### 無効な通貨ペアコード
```excel
=RssFXMarket("INVALID", "現在値")
```
結果：`#N/A`

#### 無効な取得項目
```excel
=RssFXMarket("USDJPY", "存在しない項目")
```
結果：`#VALUE!`

#### 流動性の低い時間帯
```excel
=RssFXMarket("NZDJPY", "現在値")  // アジア市場クローズ時
```
結果：レート更新頻度が低下、スプレッド拡大の可能性

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 通貨ペアコード、取得項目の形式を確認 |
| #N/A | 通貨ペアコード無効、市場休場等 | 通貨ペアコードと市場時間を確認 |
| #REF! | セル参照エラー | セル参照の指定を確認 |

## 関連関数
- **RssMarket**: 国内株式市況情報
- **RssIndexMarket**: 指数情報
- **RssMarketHeader**: 市況情報ヘッダー行作成
- **RssFOPMarket**: 先物OP市況情報

## 注意事項

1. **市場時間**: 為替市場は24時間取引のため、取引時間に注意
2. **リアルタイムデータ**: 情報更新頻度はマーケットスピード IIに準拠
3. **通貨ペアコード**: 正確な通貨ペアコードを指定する必要があります
4. **データ精度**: 為替レートは小数点以下の精度を持ちます
5. **祝日・休日**: 各国の祝日により市場が休場する場合があります

## 為替市場の特徴

| 市場 | 取引時間（日本時間） | 主要通貨ペア |
|------|---------------------|---------------|
| アジア市場 | 9:00-18:00 | USD/JPY, AUD/JPY |
| 欧州市場 | 16:00-2:00 | EUR/USD, GBP/USD |
| 米国市場 | 22:00-7:00 | USD/JPY, EUR/USD |

## 通貨ペアの読み方

| 表記 | 読み方 | 意味 |
|------|--------|------|
| USD/JPY | ドル円 | 1米ドルあたりの日本円 |
| EUR/USD | ユーロドル | 1ユーロあたりの米ドル |
| GBP/JPY | ポンド円 | 1英ポンドあたりの日本円 |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「為替レート情報」