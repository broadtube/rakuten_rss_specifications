# RssMarketDes 完全仕様書

## 概要
**関数名**: RssMarketDes  
**カテゴリ**: 市場データ (Market Data)  
**用途**: 国内株式銘柄情報の取得  

**説明**: 指定された国内株式の銘柄情報をExcelに表示します。売買単位、制限値幅上限・下限等の取引に必要な銘柄基本情報を取得できます。

## 構文 (Syntax)

```excel
RssMarketDes(ヘッダー行, "銘柄コード")
```

## パラメータ詳細

| No | パラメータ名 | データ型 | 必須/任意 | 説明 |
|----|------------|----------|-----------|------|
| 1 | ヘッダー行 | セル参照 | 任意 | 取得項目をセル範囲で指定。範囲指定は1行のみ（A1:C1形式）<br>省略時は全ての出力項目を表示。取得項目は出力項目から選択可能 |
| 2 | 銘柄コード | string | 必須 | **英数字4桁(5桁)**: 東証<br>**英数字4桁(5桁).T**: 東証<br>**英数字4桁(5桁).JAX**: JASDAQ<br>**英数字4桁(5桁).JNX**: JNX |

## 主要な出力項目

| No | 項目名 | 説明 | データ型 |
|----|--------|------|----------|
| 1 | 売買単位 | 最小取引単位（株） | number |
| 2 | 制限値幅上限 | 値幅制限の上限価格 | number |
| 3 | 制限値幅下限 | 値幅制限の下限価格 | number |

## 売買単位について

2018年10月1日より、国内株式の売買単位は100株に統一されました。

### 一般的な売買単位
- **標準**: 100株
- **特殊**: 一部銘柄では異なる単位の場合あり

## 制限値幅について

株価の急激な変動を防ぐため、前日終値を基準として制限値幅が設定されます。

### 値幅制限の仕組み
- **上限**: 制限値幅上限を超える買い注文は受付不可
- **下限**: 制限値幅下限を超える売り注文は受付不可
- **基準**: 前日終値を基準に算出

## 使用例

### 基本的な使用方法
```excel
=RssMarketDes(, "4755.T")
```
A1セルに入力すると、楽天株について国内株式銘柄情報の全取得項目を表示します。

### ヘッダー行を指定した取得
```excel
=RssMarketDes($A$2:$C$2, "7203")
```
2行目をヘッダーとして使用し、トヨタ株の銘柄情報を表示します。

### 売買単位のみ取得
A2セルに「売買単位」のヘッダーがある場合：
```excel
=RssMarketDes($A$2:$A$2, "4755")
```

### 複数銘柄の銘柄情報取得
```excel
=RssMarketDes(, "4755")  // 楽天
=RssMarketDes(, "7203")  // トヨタ
=RssMarketDes(, "9984")  // ソフトバンクG
```

## 戻り値

### 成功時の出力形式

**データ構造**: 多列連続セル出力
- **関数セル**: 全項目が表示された場合のヘッダー行
- **第2行**: 銘柄情報データ

### 実際の出力例

#### 全項目取得の例
```excel
=RssMarketDes(, "4755")
```

**出力結果**:
| 行 | 売買単位 | 制限値幅上限 | 制限値幅下限 |
|-----|-----------|----------------|----------------|
| 1(関数) | 売買単位 | 制限値幅上限 | 制限値幅下限 |
| 2 | 100 | 1450 | 850 |

#### 特定項目のみ取得
```excel
=RssMarketDes($A$1:$A$1, "7203")  // 売買単位のみ
```

**出力結果**:
| 行 | 売買単位 |
|-----|----------|
| 1(関数) | 売買単位 |
| 2 | 100 |

#### 高価格銘柄の例
```excel
=RssMarketDes(, "9984")  // ソフトバンクG(高価格)
```

**出力結果**:
| 行 | 売買単位 | 制限値幅上限 | 制限値幅下限 |
|-----|-----------|----------------|----------------|
| 1(関数) | 売買単位 | 制限値幅上限 | 制限値幅下限 |
| 2 | 100 | 6200 | 4800 |

### 出力項目別の値範囲・形式

| 項目名 | データ型 | 値の範囲・形式 | 例 | 備考 |
|--------|----------|----------------|-----|------|
| 売買単位 | number | 100株(標準) | `100`, `1000`, `10` | 株数単位、一部例外あり |
| 制限値幅上限 | number | 正数(価格) | `1450`, `6200`, `250` | 円単位、前日終値基準 |
| 制限値幅下限 | number | 正数(価格) | `850`, `4800`, `150` | 円単位、前日終値基準 |

### 株価水準別制限値幅例

| 前日終値範囲 | 制限値幅 | 例(終値800円) | 例(終値2500円) |
|-----------------|----------|------------------|-------------------|
| 100円未満 | ±30円 | - | - |
| 100-200円未満 | ±50円 | - | - |
| 200-500円未満 | ±80円 | - | - |
| 500-700円未満 | ±100円 | 上限:900円<br>下限:700円 | - |
| 700-1000円未満 | ±150円 | 上限:950円<br>下限:650円 | - |
| 1000-1500円未満 | ±300円 | - | - |
| 1500-2000円未満 | ±400円 | - | - |
| 2000-3000円未満 | ±500円 | - | 上限:3000円<br>下限:2000円 |
| 3000-5000円未満 | ±700円 | - | - |
| 5000円以上 | ±1000円+ | - | - |

### 売買単位の特徴

| 売買単位 | 適用銘柄 | 最小投資金額(例) | 特徴 |
|-------------|-----------|-------------------|------|
| 100株 | ほぼ全銘柄 | 115000円(1150円×100) | 標準的な単位 |
| 1000株 | 一部旧銘柄 | 115000円(115円×1000) | 統一前の遺産 |
| 10株 | 一部特殊銘柄 | 11500円(1150円×10) | 極めて稀 |
| 1株 | ETF等 | 1150円(1150円×1) | 投資信託等 |

### 失敗時の出力

**データ構造**: 単一セル
- **関数セル**: エラーコード（Excel標準エラー）

**可能なエラーコード**:
- `#VALUE!` - パラメータ形式エラー
- `#N/A` - 銘柄コード無効、データなし
- `#REF!` - セル参照エラー

### 特別なケース

#### 無効な銘柄コード
```excel
=RssMarketDes(, "9999")
```
結果：`#N/A`

#### 上場廃止銘柄
```excel
=RssMarketDes(, "1234")  // 上場廃止済み銘柄
```
結果：`#N/A`

#### ヘッダー行指定エラー
```excel
=RssMarketDes($A$1:$E$1, "4755")  // 5列指定だが出力は3列
```
結果：最初3列のみ表示、残りは空欄

#### 新規上場初日
```excel
=RssMarketDes(, "5678")  // 上場初日の銘柄
```
**出力結果**:
| 売買単位 | 制限値幅上限 | 制限値幅下限 |
|-----------|----------------|----------------|
| 100 | - | - |
※ 制限値幅なし(空欄または0)

#### 特殊な売買単位銘柄
```excel
=RssMarketDes(, "1111")  // 1000株単位の旧銘柄
```
**出力結果**:
| 売買単位 | 制限値幅上限 | 制限値幅下限 |
|-----------|----------------|----------------|
| 1000 | 250 | 150 |

#### 値幅制限拡大時
```excel
=RssMarketDes(, "2222")  // 連続ストップ高後の拡大措置
```
**出力結果**:
| 前日終値 | 通常値幅 | 拡大後値幅 | 上限 | 下限 |
|-----------|-----------|-------------|------|------|
| 2000円 | ±500円 | ±750円 | 2750円 | 1250円 |

#### ETFの例
```excel
=RssMarketDes(, "1306")  // TOPIX連動型ETF
```
**出力結果**:
| 売買単位 | 制限値幅上限 | 制限値幅下限 |
|-----------|----------------|----------------|
| 1 | 2150 | 1850 |
※ ETFは1口単位で取引可能

## エラーコード
| エラー | 原因 | 対処法 |
|--------|------|--------|
| #VALUE! | パラメータ形式エラー | 銘柄コードの形式を確認 |
| #N/A | 銘柄コード無効、データなし | 銘柄コードを確認 |
| #REF! | セル参照エラー | ヘッダー行の指定を確認 |

## 関連関数
- **RssMarket**: 国内株式市況情報
- **RssMarketHeader**: 市況情報ヘッダー行作成
- **RssMarginInfo**: 信用取引情報
- **RssTickList**: 歩み値データ

## 注意事項

1. **データの性質**: 銘柄情報は市況データと異なり、頻繁には変更されません
2. **制限値幅**: 前日終値を基準として日々更新されます
3. **売買単位**: 基本的に100株ですが、例外的な銘柄も存在します
4. **市場別情報**: 同一銘柄でも上場市場により情報が異なる場合があります
5. **更新タイミング**: 銘柄情報は取引開始前に更新されます

## 実用的な活用例

### 注文前の事前確認
```excel
=RssMarketDes(, "4755")
```
注文前に売買単位と制限値幅を確認

### 投資金額の計算
```excel
// A2: 銘柄コード「4755」
// B2: =RssMarket(A2, "現在値")
// C2: =RssMarketDes($D$1:$D$1, A2) // 売買単位
// D2: =B2 * C2 // 最小投資金額
```

### 制限値幅チェック
```excel
// 注文価格が制限値幅内かチェック
// A2: 注文価格
// B2: =RssMarketDes(制限値幅上限セル, "4755")
// C2: =RssMarketDes(制限値幅下限セル, "4755")  
// D2: =IF(AND(A2<=B2, A2>=C2), "OK", "制限値幅外")
```

## 制限値幅の計算方法

### 株価水準別の値幅
一般的な制限値幅の例：

| 前日終値 | 制限値幅 |
|----------|----------|
| 100円未満 | ±30円 |
| 100円以上200円未満 | ±50円 |
| 200円以上500円未満 | ±80円 |
| 500円以上700円未満 | ±100円 |
| 700円以上1000円未満 | ±150円 |
| 1000円以上1500円未満 | ±300円 |
| 1500円以上2000円未満 | ±400円 |
| 2000円以上3000円未満 | ±500円 |
| 3000円以上5000円未満 | ±700円 |

### 特別な制限値幅
- **新規上場**: 上場初日は制限値幅なし
- **ストップ安/高**: 連続する場合、値幅拡大措置
- **特別気配**: 大量の注文不均衡時

## 出力データの形式

関数実行後、以下の形式でデータが表示されます：

```
Row 1: =RssMarketDes(, "4755.T") (関数)
Row 2: [ヘッダー行] 売買単位 | 制限値幅上限 | 制限値幅下限
Row 3: [データ]     100     | 1450        | 850
```

## 銘柄情報の活用戦略

### リスク管理
1. **制限値幅**: 最大損失の把握
2. **売買単位**: 最小投資単位の確認
3. **流動性**: 取引しやすさの判断材料

### 投資計画
1. **必要資金**: 売買単位×株価で最小投資額算出
2. **分散投資**: 銘柄ごとの投資単位を考慮
3. **リスクサイジング**: 制限値幅を考慮したポジションサイズ

### 注文戦略
1. **指値注文**: 制限値幅内での価格設定
2. **成行注文**: 制限値幅での約定リスク考慮
3. **分割注文**: 売買単位を考慮した注文分割

## データ更新のタイミング

| 項目 | 更新タイミング |
|------|----------------|
| 売買単位 | 制度変更時のみ |
| 制限値幅上限 | 毎営業日朝（前日終値基準） |
| 制限値幅下限 | 毎営業日朝（前日終値基準） |

## バージョン情報
- RSS Version: 2.0
- 対応: Excel 2016以降
- 最終更新: 2024年

## 参考資料
- MARKETSPEED II RSS オンラインヘルプ
- MARKETSPEED II オンラインヘルプ「国内株式銘柄情報」
- 東京証券取引所 売買制度